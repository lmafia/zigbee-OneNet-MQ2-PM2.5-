define("kg/detail-page-pine-module/6.0.12/index",["node","node","dom","event","util","io","kg/xtemplate/4.3.0/index","kg/detail-page-pine-module/6.0.12/lib/goldlog.js"],function(i,e,t){var n,a,o,l,d=i("node"),c=i("node"),r=(i("dom"),i("event"),i("util")),p=i("io"),s=i("kg/xtemplate/4.3.0/index"),u=i("kg/detail-page-pine-module/6.0.12/lib/goldlog.js");n=function(i){"use strict";var e=d;return i=e("<style>#J_Pine{padding:17px 12px 0 15px;width:172px;_width:171px;_overflow:hidden;margin-left:1px;border-left:1px solid #e8e8e8;font:12px/1.5 tahoma,arial,'Hiragino Sans GB',sans-serif}#J_Pine ol,#J_Pine ul{list-style:none}#J_Pine .clear:after,#J_Pine .tb-clear:after,#J_Pine .tb-clearfix:after{content:'';display:block;height:0;clear:both}#J_Pine .tuijian-module-detail-pine{font-size:12px;background-color:#fff}#J_Pine .tuijian-module-detail-pine .hidden{display:none}#J_Pine .tuijian-module-detail-pine .yen{font-family:Arial;font-weight:400;padding-right:3px;color:#f50}#J_Pine .tuijian-module-detail-pine .tuijian-l{float:left;_width:70px}#J_Pine .tuijian-module-detail-pine .tuijian-r{float:right}#J_Pine .tuijian-module-detail-pine .tuijian-hd{padding:0 5px 11px}#J_Pine .tuijian-module-detail-pine .tuijian-hd .tuijian-label{height:16px;font-weight:700;color:#535353}#J_Pine .tuijian-module-detail-pine .tuijian-hd .refresh{width:16px;height:16px;background:url(//img.alicdn.com/tps/i3/T1O57XFPhcXXaSQP_X-16-16.png) no-repeat;_background-color:#fff;_background-image:none;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src=\"//img.alicdn.com/tps/i3/T1O57XFPhcXXaSQP_X-16-16.png\", sizingMethod=\"crop\");margin:4px 7px 0 0;cursor:pointer}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item{width:80px;float:left;margin-right:5px;margin-bottom:5px;position:relative}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item.last{border-bottom:1px dotted #fff}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item .tuijian-img{width:80px;height:80px}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item .tuijian-img .pic-con{width:80px;height:80px}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item .tuijian-img .pic-con a{width:80px;height:80px;line-height:80px;display:block;border:1px solid transparent;margin:-1px;vertical-align:middle}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item .tuijian-img img{display:block;margin:0 auto}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item .tuijian-img .pic-con a:hover{border:1px solid #ff4e0e}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item .img-border{position:absolute;width:78px;height:78px;margin-top:-80px;display:none}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item .tuijian-name{width:80px;height:37px;overflow:hidden;margin:7px 0 2px}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item .tuijian-name .desc{color:#9a9a9a}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item .tuijian-price{line-height:21px;margin-bottom:1px;color:#ff4805;text-align:center}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item .icon-1212{position:absolute;right:0;bottom:22px;width:32px;height:16px;background:url(//gw.alicdn.com/tps/TB1FMADNXXXXXafXVXXXXXXXXXX-34-16.png) no-repeat 0 0}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item .icon-1212-short{position:absolute;right:0;bottom:22px;width:32px;height:16px;background:url(//gw.alicdn.com/tps/TB1FMADNXXXXXafXVXXXXXXXXXX-34-16.png) no-repeat 0 0}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item .icon-1212-redpack{position:absolute;right:0;top:-1px;width:32px;height:81px;pointer-events:none;line-height:1.5}#J_Pine .tuijian-module-detail-pine .tuijian-bd .tuijian-item .icon-1212-redpack b{position:absolute;z-index:2;right:0;bottom:0;width:32px;height:16px;background:url(//img.alicdn.com/tps/i1/TB1cXvAGpXXXXaaapXXLU3sIVXX-78-48.png) no-repeat 0 0}#J_Pine .tuijian-module-detail-pine .icon-1212-redpack i{position:absolute;z-index:2;left:0;top:0;bottom:16px;width:32px;background:#cd210a;opacity:.74;filter:alpha(opacity=74)}#J_Pine .tuijian-module-detail-pine .icon-1212-redpack s{display:block;position:relative;z-index:3;padding-top:5px;padding-left:2px;letter-spacing:2px;text-align:center;color:#fff;text-decoration:none;font-style:normal;font-family:simsun,STSong,'\u5b8b\u4f53';opacity:.7;filter:alpha(opacity=70)}#J_Pine .tuijian-module-detail-pine .icon-1212-redpack em{display:block;position:relative;z-index:3;text-align:center;font-family:simsun,STSong,'\u5b8b\u4f53';color:#fff}#J_Pine .tuijian-module-detail-pine .pic-con a{display:block}#J_Pine .tuijian-module-detail-pine .pic-con a:hover .icon-1212-redpack em,#J_Pine .tuijian-module-detail-pine .pic-con a:hover .icon-1212-redpack i,#J_Pine .tuijian-module-detail-pine .pic-con a:hover .icon-1212-redpack s{display:none}</style>").appendTo("head")}(),a=function(i){var e=c,t=r;return i=function n(){function i(i){if(i){var e="hold_"+(new Date).getTime(),t=window[e]=new Image;t.onload=t.onerror=function(){window[e]=null},t.src=i,t=null}}function a(i){var e=i.indexOf("?")>-1?"&":"?",t=(new Date).getTime();return i+e+"t="+t}var o=e;o.log=function(i){window.console&&window.console.log&&console.log(i)},t.augment(n,{log:function(e,n){if(!n)return void o.log("log code \u5fc5\u987b\uff01");e=t.merge(e,{url:encodeURI(location.href.replace(location.hash,""))});var l="//gm.mmstat.com/"+n+"?"+t.param(e);o.log("\u57cb\u70b9\u53d1\u51fa\uff1a"+l),i(a(l))}})}}(),o=function(i){function e(i){function e(i){return this.container=g.one("#J_Pine"),this.container?(this.sellerid=this.container.attr("data-sellerid"),this.categoryid=this.container.attr("data-catid"),this.itemid=this.container.attr("data-itemid"),this.shopid=this.container.attr("data-shopid"),this.sellerid&&this.categoryid&&this.itemid?i.height?(this.appid=6862,this.appid_daily=19670,this.count=r(i.height),this.bindEvent(),void this.request(!0)):void g.log("\u8bf7\u4f20\u5165\u9875\u9762\u9ad8\u5ea6\u914d\u7f6e\u9879\uff01"):void g.log("\u672a\u83b7\u53d6\u5230sellerid\u6216categoryid\u6216itemid!")):void g.log("\u672a\u627e\u5230J_Pine\u6a21\u5757\uff01")}function d(i,e){var t,n={list:[]};if(!i.result)return n;for(;t=i.result.shift();)if(s(t,["itemName","url","pic","price","promotionPrice"])){if(t.promotionPrice&&(t.price=t.promotionPrice),t.extMap&&t.extMap.price20141212&&(t.price=t.extMap.price20141212),t.icon1212="",t.extMap&&t.extMap.dacuIcon)switch(t.extMap.dacuIcon){case"taobao":t.icon1212='<img class="icon-1212-short" src="//img.alicdn.com/tps/TB170BXOXXXXXbmXVXXXXXXXXXX-32-16.png" alt="">';break;case"jingxuan":t.icon1212='<img class="icon-1212" src="//img.alicdn.com/tps/TB1gYRtLpXXXXb5XXXXXXXXXXXX-72-16.png" alt="">';break;case"tmall":t.icon1212='<img class="icon-1212" src="//img.alicdn.com/tps/TB1F3p4OpXXXXXPaFXXXXXXXXXX-32-16.png" alt="">';break;case"yushou":t.icon1212='<img class="icon-1212" src="//img.alicdn.com/tps/TB1syPJKpXXXXXHapXXXXXXXXXX-118-32.png" alt="">';break;case"hanglv":t.icon1212='<img class="icon-1212" src="//gw.alicdn.com/tps/TB1_qvxNXXXXXXMaXXXXXXXXXXX-32-16.png" alt="">';break;case"xinshili":t.icon1212='<img class="icon-1212" src="//img.alicdn.com/tps/TB1lwJ5MFXXXXb8XXXXXXXXXXXX-46-16.png" alt="">';break;default:t.icon1212=""}if(t.extMap&&t.extMap.redpack20141212&&(t.icon1212='<i class="icon-1212-redpack"><s>\u8d2d\u7269\u52b5\u62b5</s><b></b><i></i><em>'+t.extMap.redpack20141212+"\u5143</em></i>"),t.auctionTags){var a=(new Date).getTime();if(15120576e5<=a&&a<15130944e5)switch(t.auctionTags){case"2882":t.icon1212='<img class="icon-1212" src="//img.alicdn.com/tfs/TB1DcsIblTH8KJjy0FiXXcRsXXa-32-16.png" alt="">';break;case"18132":t.icon1212='<img class="icon-1212" src="//gw.alicdn.com/tfs/TB1nYVya6ihSKJjy0FeXXbJtpXa-72-36.png?getAvatar=avatar" alt="">'}}if(n.list.push({name:c(t.itemName),extMap:c(t.extMap),url:c(t.url),pic:c(t.pic+"_80x80.jpg"),price:c(p(t.price)),icon1212:t.icon1212}),n.list.length>=e)break}return n}function c(i){return"string"==typeof i&&(i=i.replace(/</g,"&lt;"),i=i.replace(/>/g,"&gt;"),i=i.replace(/'/g,"&apos;"),i=i.replace(/"/g,"&quot;")),i}function r(i){var e=102,t=31;return 2*Math.floor((i-t)/e)}function p(i){return i>99999999?parseFloat(i/1e8).toFixed(1)+"\u4ebf":i>9999?parseFloat(i/1e4).toFixed(1)+"\u4e07":parseFloat(i).toFixed(2)}function s(i,e){var t,n=!0;for(t=0;t<e.length;t++)i.hasOwnProperty(e[t])||(n=!1);return n}var u=1,m=[],g=t;g.log=function(i){window.console&&window.console.log&&console.log(i)},a.augment(e,{request:function(i){var e=this;if(m[u-1])e.render(a.clone(m[u-1]));else{var t="tui.taobao.com",o=e.appid;window.Hub&&null!==Hub.config.get("cdn_rate")&&(t=100*Math.random()>Hub.config.get("cdn_rate")?"tui.taobao.com":"htui.alicdn.com"),location.host.indexOf("pre")!=-1&&(t="tuipre.taobao.com"),location.href.indexOf("daily")>-1&&(t="tui.daily.taobao.net",o=e.appid_daily),new n({type:"get",url:"//"+t+"/recommend?appid="+o+"&count="+e.count+"&pNum="+(u-1>0?u-1:0),data:{seller_id:e.sellerid,shop_id:e.shopid,item_ids:e.itemid,floorId:42296,pSize:4},success:function(t){m[u-1]=a.clone(t),e.render(t,i)},error:function(i,e){g.log("detail_pine module ajax error: "+i)},dataType:"jsonp",jsonp:"callback",jsonpCallback:"detail_pine",cache:!0})}},render:function(i,e){var t=this;if(i&&i.result&&i.result.length>0){var n,a,l='<div class="refresh"></div>';1!=u||i.hasMore||(l='<div class="refresh hidden"></div>'),n="<ul>{{#each(list)}}{{#if(xindex==="+(i.result.length-1)+')}}<li class="tuijian-item last">{{else}}<li class="tuijian-item">{{/if}}<div class="tuijian-l"><div class="tuijian-img clearfix"><div class="pic-con"><a href="{{this.url}}" title="{{this.name}}" target="_blank" class="img-con"><img src="{{this.pic}}" title="{{this.name}}" alt="{{this.name}}" />{{{this.icon1212}}}</a></div></div><p class="tuijian-price"><span class="now-price"><b class="yen">&yen;</b><b class="price">{{this.price}}</b></span></p></div></li>{{/each}}</ul>',a='<div class="tb-clearfix tuijian-module tuijian-module-detail-pine"><div class="tuijian-hd tb-clearfix"><div class="tuijian-l"><h2 class="tuijian-label">\u770b\u4e86\u53c8\u770b</h2></div><div class="tuijian-r">'+l+'</div></div><div class="tuijian-bd tb-clearfix">'+n+"</div></div>",e?t.container.html(new o(a).render(d(i,t.count))).fadeIn(.3):g.one(".tuijian-bd",t.container).fadeOut(.3,function(){g.one(".tuijian-bd",t.container).html(new o(n).render(d(i,t.count)))}).fadeIn(.3),i.hasMore&&u<3?u++:u=1}},bindEvent:function(){var i=this;i.container.delegate("click",".refresh",function(e){(new l).log({},"minisite.3.1"),i.request(!1)})}}),new e(i)}var t=c,n=p,a=r,o=s,l=u;return i=e}(),l=function(i){return i=o}(),t.exports=l});