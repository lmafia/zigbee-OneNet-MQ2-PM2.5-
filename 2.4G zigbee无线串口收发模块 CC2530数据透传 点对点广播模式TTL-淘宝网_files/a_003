KISSY.add("modules/base/common/index",function(a,b,c){var d={getVdata:function(a){if(window.login_config)return a(null,window.login_config);var d=new c(location.href).getQuery(),e={mockDate:d.get("mockDate"),isAudit:d.get("isAudit")};b({type:"get",data:e,dataType:"jsonp",url:"/i/vdata.htm?"+location.search.substr(1),success:function(b){return window.login_config=b,a(null,b)}})}};return d},{requires:["io","uri"]}),KISSY.add("modules/base/header/index",function(a,b){var c=a.Node.all,d={addExpireNotice:function(){var a=c("#header");if(0!==a.length){var b=a.attr("data-wangpu-left-days"),d="//fuwu.taobao.com/ser/detail.html?service_code=App_Service_W_Shop";b&&Number(b)>0&&Number(15>=b)&&this._isShopMaster(function(c,e){if(!c&&e){var f='<div class="header-expire-tips"><i class="icon-tips">!</i>\u60a8\u7684\u4e13\u4e1a\u7248\u65fa\u94fa<span class="highlight"> '+b+' \u5929\u540e\u5230\u671f</span>\uff0c\u8bf7\u53ca\u65f6\u7eed\u8d39\uff0c\u907f\u514d\u8fc7\u671f\u3002<a href="'+d+'" target="_blank">\u7acb\u5373\u7eed\u8d39</a>\u3002\u7eed\u8d39\u6210\u529f\u540e\uff0c\u672c\u63d0\u9192\u4f1a\u5728\u4e09\u5929\u5185\u6d88\u5931\u3002</div>';a.append(f)}})}},_isShopMaster:function(a){b.getVdata(function(b,c){a(null,c.loginUserId===window.shop_config.userId)})}};return d},{requires:["modules/base/common/index"]}),KISSY.add("modules/shop/header-v2/index",function(a,b,c,d,e){function f(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function g(){window.temp_ua=window.ua,UA_Opt.Token=(new Date).getTime()+":"+Math.random(),UA_Opt.reload&&UA_Opt.reload()}function h(b){var c=a.now();return b+(-1===b.indexOf("?")?"?":"&")+"t="+c}function i(b){var c=a.DOM.val("#J_TokenField");return b+(-1===b.indexOf("?")?"?":"&")+"_tb_token_="+c}function j(a,b,c){var d=Math.ceil(.45*m.viewportHeight()+m.scrollTop())-c/2,e=Math.ceil((m.docWidth()-b)/2);m.offset(a,{top:d,left:e})}function k(a,b,c,d){g();var e='<a class="close-btn" href="#">X</a><iframe src="'+d+"&ua="+encodeURIComponent(window.temp_ua)+'" width="'+b+'" height="'+c+'" name="popupIframe" frameborder="0" scrolling="no"></iframe><div class="tb-canvas"></div>';m.css(a,"display","none"),m.html(a,e),m.css(a,{visibility:"visible",display:"block",width:b,height:c}),j(a,b,c)}var a=KISSY,l=a.Event,m=a.DOM,n=(a.Cookie,a.Ajax),o=(document.all,window,document,a.UA),p=a.Node.all,q=!window.shop_config,r={item:q?"2013.1.1975045609.d4916909":"a1z10.1.1996643285.d4916901",shop:q?"2013.1.1975045609.d4916913":"a1z10.1.1996643285.d4916905"};return a.augment(f,{_init:function(){a.log("TshopPsmShopHeader init start");var b=this;b._initSM(),b._initIdTime(),b._initColloctWeitaoContainer(),b._initPanelHover(),b._initSearch(),b._initCollect(),b._initWeitaoHover(),b._initWeitaoBtn(),b._initQRLink(),b._initQualification(),b._initImpression(),b._initGoldLogForNewHeaderAndSignboardAndWWHover(),e.addExpireNotice(),a.log("TshopPsmShopHeader init end")},_initSM:function(){window.ua&&window.UA_Opt&&window.UA_Opt.reload||(window.ua="",window.temp_ua="",window.UA_Opt=new Object,UA_Opt.isSendError=1,UA_Opt.LogVal="ua",UA_Opt.SendMethod=8,UA_Opt.MaxKSLog=10,UA_Opt.MaxMCLog=10,UA_Opt.MaxMPLog=10,UA_Opt.MPInterval=50,UA_Opt.MaxFocusLog=10,UA_Opt.MaxGPLog=10,UA_Opt.MaxTcLog=10,UA_Opt.Flag=97422,a.getScript("//uaction.alicdn.com/js/uab.js",{success:function(){window.temp_ua=window.ua,UA_Opt.Token=(new Date).getTime()+":"+Math.random(),UA_Opt.reload&&UA_Opt.reload()}}))},_initIdTime:function(){for(var a=p("[name=microscope-data]").attr("content").split(";"),c=0,d=0;d<a.length;d++){var e=a[d].split("=");"shopId"==e[0]&&(c=e[1])}var f=location.host.indexOf("daily")>-1?"//shop.daily.taobao.net/getShopInfo.htm":"//shop.taobao.com/getShopInfo.htm";b.get(f,{shopId:c},function(a){a&&a.data&&a.data.starts&&p(".J_id_time").html(a.data.starts)},"jsonp")},_initPanelHover:function(){var a=this,b=m.get(".J_TShopSummary",a._mod),c=m.get(".J_TShopLeft",a._mod),d=m.get(".J_TSummaryPopup",a._mod),e=[c,d],f=!1,g=null;l.on(e,"mouseenter",function(){f=!0,g&&clearTimeout(g),g=setTimeout(function(){f&&m.addClass(b,"hover")},300)}),l.on(e,"mouseleave",function(){f=!1,g&&clearTimeout(g),g=setTimeout(function(){!f&&m.removeClass(b,"hover")},100)})},_initQualification:function(){function a(a){var b=a,c=m.siblings(b);m.addClass(b,"actived"),m.removeClass(c,"actived")}function b(b){if(o.ie&&o.ie<=6)return void c(b);if(b){if(1===i)return;i--}else{if(i>=j)return;i++}m.removeClass(e,"page2 page3"),m.addClass(e,"page"+i),a(h[3*(i-1)])}function c(b){if(b){if(1===i)return;i--}else if(b===!1){if(i>=j)return;i++}var c=3*(i-1),d=[].slice.call(h,c,c+3);m.hide(h),m.css(d,"display","inline"),a(h[c])}var d=this,e=m.get(".J_TQLFTBox",d._mod),f=m.get(".J_TQLeft",d._mod),g=m.get(".J_TQRight",d._mod),h=m.query(".J_TIconItem",d._mod),i=1,j=Math.ceil(h.length/3);o.ie&&o.ie<=6&&c(),l.on(f,"click",function(){b(!0)}),l.on(g,"click",function(){b(!1)}),l.delegate(e,"mouseenter",".J_TIconItem",function(b){a(b.currentTarget)}),a(h[0])},_initSearch:function(){var a=this,b=m.get("#J_TSearchForm");a._initSearchTab(),a._setSearchTips(),a._initSearchFunc(),a._handleSearchMonitor(b)},_initSearchTab:function(){var a=this,b=m.get("#J_SearchTab"),c=m.get("#J_TSearchForm"),d=m.get("#q"),e=m.get(".btn-search",a._mod);l.on(b,"mouseenter",function(){m.addClass(b,"hover")}),l.on(b,"mouseleave",function(){m.removeClass(b,"hover")}),l.delegate(b,"click",".J_SearchTab",function(a){a.halt();var e=a.currentTarget,f=m.siblings(e),g=m.attr(e,"data-action"),h=m.attr(e,"data-goldlogid"),i=m.attr(e,"data-searchtype");g&&(c.action=g)&&(h?c.setAttribute("data-goldlogid",h):c.removeAttribute("data-goldlogid")),m.val("#J_TSearchSPM","item"==i?r.item:r.shop),m.addClass(e,"selected"),m.removeClass(f,"selected"),m.removeClass(b,"hover"),m.insertBefore(e,f),d.focus()}),l.on(e,"click",function(){var a=m.attr(c,"data-goldlogid");if(a){var b="//gm.mmstat.com"+a+"?logtype=2";goldlog.send(b)}})},_initSearchFunc:function(){var b="1.4.7/",c=",tbc/search-suggest/"+b,d=["dom","index","plugin/tab","new_suggest.css"],e=["list"];a.use("event,"+d.join(c),function(a,b,c,d,f){var g=new d({plugins:[new f({activeCls:"selected",node:"#J_SearchTab li.J_SearchTab"})],sugConfig:{sourceUrl:"//suggest.taobao.com/sug?k=1",node:"#q",resultFormat:"",isSendByForm:!1},mods:{sort:e}});g.on("beforeFocus",function(){var a=g.get("form");c.addClass(a,"search-panel-focused")}),g.on("beforeBlur",function(){var a=g.get("form");c.removeClass(a,"search-panel-focused")}),b.on(".search-panel-fields","mouseenter",function(a){var b=a.relatedTarget,d=c.get(".search-button");c.contains(d,b)&&c.addClass(".search-panel","search-panel-hover")}),b.on(".search-panel","mouseenter mouseleave",function(a){var b,d,e="mouseenter"===a.type,f=a.currentTarget,g=c.get(".search-button");e?(b=a.target,d="addClass"):(b=a.relatedTarget,d="removeClass"),c.contains(g,b)||c[d].call(this,f,"search-panel-hover")})})},_setSearchTips:function(){function a(){c.value?m.addClass(b,"focus"):m.removeClass(b,"focus")}var b=m.get("#J_TSearchForm"),c=m.get("#q");m.get("#J_SearchIcon");l.on(c,"focus valuechange",a),a()},_handleSearchMonitor:function(a){window.g_config&&(appId=window.g_config.appId)&&(sourceId=16===appId?"ratez":"shopz",function(b){function c(){var a=new Date,b=a.getMonth()+1;10>b&&(b="0"+b);var c=a.getDate();return 10>c&&(c="0"+c),[a.getFullYear(),b,c].join("")}var d=document.createElement("input");d.setAttribute("type","hidden"),d.setAttribute("name","initiative_id"),d.value=b+"_"+c(),m.append(d,a)}(sourceId))},_initCollect:function(){var a=this;a._handleTriggerCollect()},_handleTriggerCollect:function(){var a=this,b=m.get("#popupPanel");l.delegate(a._mod,"click",".J_TCollectShop",function(a){a.preventDefault();var c=a.target,d=p("#J_FavoriteIframeWidth").val()||c.getAttribute("data-width"),e=p("#J_FavoriteIframeHeight").val()||c.getAttribute("data-height"),f=i(h(c.href));k(b,d,e,f)})},_initWeitaoHover:function(){var a=this,b=!1,c=m.get(".J_TWeiTaoPopup",a._mod),d=m.get(".J_TWeitaoHover",a._mod),e=[c,d],f=null;c&&d&&(m.viewportHeight()<9999&&setTimeout(function(){!b&&m.removeClass(c,"show")},2e3),l.on(e,"mouseenter",function(){b=!0,f&&clearTimeout(f),f=setTimeout(function(){b&&m.addClass(c,"show")},200)}),l.on(e,"mouseleave",function(){b=!1,f&&clearTimeout(f),f=setTimeout(function(){!b&&m.removeClass(c,"show")},80)}))},_initWeitaoBtn:function(){var a=this,b=m.get("#popupPanel");l.delegate(a._mod,"click",".J_TWeitaoFlw",function(a){a.preventDefault();var c=a.currentTarget,d=c.getAttribute("data-width"),e=c.getAttribute("data-height");TB.Global.use("fn-login",function(a,f){f.Mini.popup(function(){var a=i(h(c.href));k(b,d,e,a)})})})},_initColloctWeitaoContainer:function(){var a=m.get("#popupPanel");a||(a=m.create('<div id="popupPanel">'),m.append(a,"body"),l.delegate(a,"click",".close-btn",function(b){b.preventDefault(),m.hide(a),iframe=m.get("iframe",a),iframe.contentWindow.sendInvite&&iframe.contentWindow.sendInvite(),m.empty(a)}))},_initQRLink:function(){var a=m.query(".J_TQRLinkShop","body"),b=m.query(".J_TQRLinkDetail","body");a&&l.delegate("body","click",".J_TQRLinkShop",function(a){a.preventDefault();var b=440,c=260,d=m.get(".J_TQRCodeShop"),e=d.src,f=m.get("#popupPanel"),g=m.get(".follow-mobile",self._mod),h=g?"//www.taobao.com/go/act/shop/pop.php?pic=":"//www.taobao.com/go/act/weitao/pop.php?pic=",i=h+encodeURIComponent(e);k(f,b,c,i)}),b&&l.delegate("body","click",".J_TQRLinkDetail",function(a){a.preventDefault();var b=440,c=260,d=m.get("#J_TWeitaoQRCode"),e=d.src,f=m.get("#popupPanel"),g="//www.taobao.com/go/act/detail/pop.php?pic="+e;k(f,b,c,g)})},_initImpression:function(){if(window.shop_config&&shop_config.hasImpress){var a=this,b=m.get(".J_TPopupFold",a._mod),c=m.get(".J_THeadCtrlBtns",a._mod);userId=window.shop_config?shop_config.userId||shop_config.isvStat.userId:g_config.sellerId,isDaily=location.host.indexOf("taobao.com")<0,colors=["red","green","blue","brown"],url=isDaily?"//count.config-vip.taobao.net:8888/counter3":"//count.taobao.com/counter5",n({url:url,data:{keys:"SIP_184_"+userId},type:"get",dataType:"jsonp",scriptCharset:"utf-8",success:function(d){if(d&&d["SIP_184_"+userId]&&d["SIP_184_"+userId].majorImprList){var e,f=d["SIP_184_"+userId].majorImprList,g=0,h="",i='<p class="impress-wrap"><span class="impress-title">\u5e97\u94fa\u5370\u8c61</span>',j=["tbwmdd.1.116","tbwmdd.1.117","tbwmdd.1.118","tbwmdd.1.119"];for(g;g<f.length;g++)e=f[g],color=colors[g%4],i+='<a data-goldlogid="'+j[g]+'" class="J_TImpressLog word '+color+'" target="_blank" href="//goodshop.taobao.com/impressiondetail/impressionDetail.htm?sellerId='+userId+"&impressionId="+e.imprId+'">'+e.imprText+"</a>",0===g&&(h='<span class="shop-impress"><a data-goldlogid="tbwmdd.1.115" class="J_TImpressLog" target="_blank" href="//goodshop.taobao.com/impressiondetail/impressionDetail.htm?sellerId='+userId+"&impressionId="+e.imprId+'">'+e.imprText+"</a></span>");i+="</p>",m.insertBefore(m.create(h),b),m.insertBefore(m.create(i),c),l.delegate(a._mod,"click",".J_TImpressLog",function(a){var b=a.target,c=b.getAttribute("data-goldlogid"),d="//gm.mmstat.com"+c+"?logtype=2";goldlog.send(d)})}}})}},_initGoldLogForNewHeaderAndSignboardAndWWHover:function(){l.delegate("body","click",".J_TGoldlog",function(b){var c=b.currentTarget,d=a.DOM.attr(c,"data-goldlog-id"),e="//gm.mmstat.com"+d+"?logtype=2";goldlog.send(e)})}}),f.selector=".tshop-psm-shop-header2",f},{requires:["ajax","cookie","overlay","modules/base/header/index"]});KISSY.add("modules/shop/header-enterprise/mods/search",function(a,b,c){var d=b.all,e=function(a){var b=d(".J_Search",a),e=(new c({plugins:[],sugConfig:{sourceUrl:"//suggest.taobao.com/sug?k=1&area=c2c",node:d(".J_Suggest",b),focused:!1,resultFormat:""},mods:{sort:["list"]}}),d(".J_SecondarySearch",b));e.on("click",function(){var a=e.attr("data-action");a&&d(".J_SearchForm",b).attr("action",a)});var f=d(".J_PrimarySearch",b);f.on("click",function(){})};return e},{requires:["node","tbc/search-suggest/1.4.7/index","tbc/search-suggest/1.4.7/new_suggest.css"]}),KISSY.add("modules/base/common/index",function(a,b,c){var d={getVdata:function(a){if(window.login_config)return a(null,window.login_config);var d=new c(location.href).getQuery(),e={mockDate:d.get("mockDate"),isAudit:d.get("isAudit")};b({type:"get",data:e,dataType:"jsonp",url:"/i/vdata.htm?"+location.search.substr(1),success:function(b){return window.login_config=b,a(null,b)}})}};return d},{requires:["io","uri"]}),KISSY.add("modules/base/header/index",function(a,b){var c=a.Node.all,d={addExpireNotice:function(){var a=c("#header");if(0!==a.length){var b=a.attr("data-wangpu-left-days"),d="//fuwu.taobao.com/ser/detail.html?service_code=App_Service_W_Shop";b&&Number(b)>0&&Number(15>=b)&&this._isShopMaster(function(c,e){if(!c&&e){var f='<div class="header-expire-tips"><i class="icon-tips">!</i>\u60a8\u7684\u4e13\u4e1a\u7248\u65fa\u94fa<span class="highlight"> '+b+' \u5929\u540e\u5230\u671f</span>\uff0c\u8bf7\u53ca\u65f6\u7eed\u8d39\uff0c\u907f\u514d\u8fc7\u671f\u3002<a href="'+d+'" target="_blank">\u7acb\u5373\u7eed\u8d39</a>\u3002\u7eed\u8d39\u6210\u529f\u540e\uff0c\u672c\u63d0\u9192\u4f1a\u5728\u4e09\u5929\u5185\u6d88\u5931\u3002</div>';a.append(f)}})}},_isShopMaster:function(a){b.getVdata(function(b,c){a(null,c.loginUserId===window.shop_config.userId)})}};return d},{requires:["modules/base/common/index"]}),KISSY.add("modules/shop/header-enterprise/index",function(a,b,c,d,e,f){function g(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function h(){window.temp_ua=window.ua,UA_Opt.Token=(new Date).getTime()+":"+Math.random(),UA_Opt.reload&&UA_Opt.reload()}function i(b){var c=a.now();return b+(-1===b.indexOf("?")?"?":"&")+"t="+c}function j(b){var c=a.DOM.val("#J_TokenField");return b+(-1===b.indexOf("?")?"?":"&")+"_tb_token_="+c}function k(a,b,c){var d=Math.ceil(.45*n.viewportHeight()+n.scrollTop())-c/2,e=Math.ceil((n.docWidth()-b)/2);n.offset(a,{top:d,left:e})}function l(a,b,c,d){h();var e='<a class="close-btn" href="#">X</a><iframe src="'+d+"&ua="+encodeURIComponent(window.temp_ua)+'" width="'+b+'" height="'+c+'" name="popupIframe" frameborder="0" scrolling="no"></iframe><div class="tb-canvas"></div>';n.css(a,"display","none"),n.html(a,e),n.css(a,{visibility:"visible",display:"block",width:b,height:c}),k(a,b,c)}var m=a.Event,n=a.DOM,o=(a.Cookie,a.Ajax,document.all,window,document,a.UA),p=a.Node.all;!window.shop_config;return a.augment(g,{_init:function(){a.log("TshopPsmShopHeader init start");var b=this;e(b._mod),b._initSM(),b._initIdTime(),b._initPanelHover(),b._initWeitaoHover(),b._initColloctWeitaoContainer(),b._initQRLink(),b._initCollect(),b._initQualification(),b._initGoldLogForNewHeaderAndSignboardAndWWHover(),f.addExpireNotice(),a.log("TshopPsmShopHeader init end")},_initIdTime:function(){for(var a=p("[name=microscope-data]").attr("content").split(";"),c=0,d=0;d<a.length;d++){var e=a[d].split("=");"shopId"==e[0]&&(c=e[1])}var f=location.host.indexOf("daily")>-1?"//shop.daily.taobao.net/getShopInfo.htm":"//shop.taobao.com/getShopInfo.htm";b.get(f,{shopId:c},function(a){a&&a.data&&a.data.starts&&p(".J_id_time").html(a.data.starts)},"jsonp")},_initSM:function(){window.ua&&window.UA_Opt&&window.UA_Opt.reload||(window.ua="",window.temp_ua="",window.UA_Opt=new Object,UA_Opt.isSendError=1,UA_Opt.LogVal="ua",UA_Opt.SendMethod=8,UA_Opt.MaxKSLog=10,UA_Opt.MaxMCLog=10,UA_Opt.MaxMPLog=10,UA_Opt.MPInterval=50,UA_Opt.MaxFocusLog=10,UA_Opt.MaxGPLog=10,UA_Opt.MaxTcLog=10,UA_Opt.Flag=97422,a.getScript("//uaction.alicdn.com/js/uab.js",{success:function(){window.temp_ua=window.ua,UA_Opt.Token=(new Date).getTime()+":"+Math.random(),UA_Opt.reload&&UA_Opt.reload()}}))},_initPanelHover:function(){var a=this,b=n.get(".J_TShopSummary",a._mod),c=!1,d=null;m.delegate(a._mod,"mouseenter",".J_TShopSummary",function(){c=!0,d&&clearTimeout(d),d=setTimeout(function(){c&&n.addClass(b,"hover")},300)}),m.delegate(a._mod,"mouseenter",".J_TSummaryPopup",function(){c=!0,d&&clearTimeout(d),d=setTimeout(function(){c&&n.addClass(b,"hover")},300)}),m.delegate(a._mod,"mouseleave",".J_TShopSummary",function(){c=!1,d&&clearTimeout(d),d=setTimeout(function(){!c&&n.removeClass(b,"hover")},100)}),m.delegate(a._mod,"mouseleave",".J_TSummaryPopup",function(){c=!1,d&&clearTimeout(d),d=setTimeout(function(){!c&&n.removeClass(b,"hover")},100)})},_initWeitaoHover:function(){var a=this,b=!1,c=n.get(".J_TWeiTaoPopup",a._mod),d=n.get(".J_TWeitaoHover",a._mod),e=null;c&&d&&(n.viewportHeight()<9999&&setTimeout(function(){!b&&n.removeClass(c,"show")},2e3),m.delegate(a._mod,"mouseenter",".J_TWeiTaoPopup",function(){b=!0,e&&clearTimeout(e),e=setTimeout(function(){b&&n.addClass(c,"show")},200)}),m.delegate(a._mod,"mouseleave",".J_TWeiTaoPopup",function(){b=!1,e&&clearTimeout(e),e=setTimeout(function(){!b&&n.removeClass(c,"show")},80)}),m.delegate(a._mod,"mouseenter",".J_TWeitaoHover",function(){b=!0,e&&clearTimeout(e),e=setTimeout(function(){b&&n.addClass(c,"show")},200)}),m.delegate(a._mod,"mouseleave",".J_TWeitaoHover",function(){b=!1,e&&clearTimeout(e),e=setTimeout(function(){!b&&n.removeClass(c,"show")},80)}))},_initQualification:function(){function a(a){var b=a,c=n.siblings(b);n.addClass(b,"actived"),n.removeClass(c,"actived")}function b(b){if(o.ie&&o.ie<=6)return void c(b);if(b){if(1===i)return;i--}else{if(i>=j)return;i++}n.removeClass(e,"page2 page3"),n.addClass(e,"page"+i),a(h[3*(i-1)])}function c(b){if(b){if(1===i)return;i--}else if(b===!1){if(i>=j)return;i++}var c=3*(i-1),d=[].slice.call(h,c,c+3);n.hide(h),n.css(d,"display","inline"),a(h[c])}var d=this,e=n.get(".J_TQLFTBox",d._mod),f=n.get(".J_TQLeft",d._mod),g=n.get(".J_TQRight",d._mod),h=n.query(".J_TIconItem",d._mod),i=1,j=Math.ceil(h.length/3);o.ie&&o.ie<=6&&c(),m.on(f,"click",function(){b(!0)}),m.on(g,"click",function(){b(!1)}),m.delegate(e,"mouseenter",".J_TIconItem",function(b){a(b.currentTarget)}),a(h[0])},_initCollect:function(){var a=this;a._handleTriggerCollect()},_initColloctWeitaoContainer:function(){var a=n.get("#popupPanel");a||(a=n.create('<div id="popupPanel">'),n.append(a,"body"),m.delegate(a,"click",".close-btn",function(b){b.preventDefault(),n.hide(a),iframe=n.get("iframe",a),iframe.contentWindow.sendInvite&&iframe.contentWindow.sendInvite(),n.empty(a)}))},_handleTriggerCollect:function(){var a=this,b=n.get("#popupPanel");m.delegate(a._mod,"click",".J_TCollectShop",function(a){a.preventDefault();var c=a.target,d=p("#J_FavoriteIframeWidth").val()||c.getAttribute("data-width"),e=p("#J_FavoriteIframeHeight").val()||c.getAttribute("data-height"),f=j(i(c.href));l(b,d,e,f)})},_initQRLink:function(){var a=n.query(".J_TQRLinkShop","body"),b=n.query(".J_TQRLinkDetail","body");a&&m.delegate("body","click",".J_TQRLinkShop",function(a){a.preventDefault();var b=440,c=260,d=n.get(".J_TQRCodeShop"),e=d.src,f=n.get("#popupPanel"),g=n.get(".follow-mobile",self._mod),h=g?"//www.taobao.com/go/act/shop/pop.php?pic=":"//www.taobao.com/go/act/weitao/pop.php?pic=",i=h+encodeURIComponent(e);l(f,b,c,i)}),b&&m.delegate("body","click",".J_TQRLinkDetail",function(a){a.preventDefault();var b=440,c=260,d=n.get("#J_TWeitaoQRCode"),e=d.src,f=n.get("#popupPanel"),g="//www.taobao.com/go/act/detail/pop.php?pic="+e;l(f,b,c,g)})},_initGoldLogForNewHeaderAndSignboardAndWWHover:function(){m.delegate("body","click",".J_TGoldlog",function(b){var c=b.currentTarget,d=a.DOM.attr(c,"data-goldlog-id"),e="//gm.mmstat.com"+d+"?logtype=2";goldlog.send(e)})}}),g.selector=".tshop-psm-shop-header-enterprise",g},{requires:["ajax","cookie","overlay","./mods/search","modules/base/header/index"]});KISSY.add("modules/shop/nav-ch/index",function(a,b,c){function d(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function e(b,c){a.each(b,function(a){f.delegate(c,"mouseenter",a.selector,function(b){g.addClass(b.currentTarget,a.hClass)}),f.delegate(c,"mouseleave",a.selector,function(b){g.removeClass(b.currentTarget,a.hClass)})})}var f=a.Event,g=a.DOM,h=a.Node,i=h.all;return a.augment(d,{_init:function(){a.log("TshopPbsmShopNavCh init start");var b=this;b._menuHighlight(),b._initScroll(),a.ready(function(){b._menuPopup(),b._bindEvt(),b._setInherentStyle(),b._fixMaxHeight(),e([{selector:".all-cats",hClass:"all-cats-hover"},{selector:".fst-cat",hClass:".cat-hd-hover"},{selector:".snd-cat-hd",hClass:".snd-cat-hd-hover"},{selector:".menu",hClass:".menu-hover"},{selector:".sub-cat",hClass:".sub-cat-hover"}],g.query(".tshop-pbsm-shop-nav-ch"))}),a.log("TshopPbsmShopNavCh init end")},_menuHighlight:function(){var b=g.get("#J_TSelectedMenuInfo");if(b){var c=a.JSON.parse(g.val(b)).selectedMenu,d=g.query(".menu",self._mod),e=g.get(".menu-selected",self._mod);if(e&&g.removeClass(e,"menu-selected"),""!=c.catId){for(var f=0;f<d.length;f++)if(g.attr(d[f],"data-cat-id")==c.catId){g.addClass(d[f],"menu-selected");break}}else if(""!=c.pageId){for(var f=0;f<d.length;f++)if(g.attr(d[f],"data-page-id")==c.pageId){g.addClass(d[f],"menu-selected");break}}else if(""!=c.linkId)for(var f=0;f<d.length;f++)if(g.attr(d[f],"data-link-id")==c.linkId){g.addClass(d[f],"menu-selected");break}}},_initScroll:function(){if(i(this._mod).hasClass("J_inView")){var a=this,b=i(a._mod).offset().top,c=0;window.location.href.indexOf("preview.htm")>0&&(c=parseInt(i("#page").css("padding-top"))),i(window).on("scroll",function(d){i(document).scrollTop()>=b-c?i(a._mod).hasClass("fixed")||(i(a._mod).addClass("fixed"),i(a._mod).css("top",c+"px")):i(a._mod).hasClass("fixed")&&i(a._mod).removeClass("fixed")})}},_menuPopup:function(){function c(){a.later(function(){if(0!==j.length){try{d(j.shift())}catch(b){a.log("\u521d\u59cb\u5316\u7ec4\u4ef6\u51fa\u9519")}c()}},0)}function d(c){var d=g.get(".all-cats-popup",f),e=c,h=g.next(e,".snd-pop");if(h){var i=g.height(d);if(a.version.indexOf("1.4")>=0){g.hide(h),g.html(h,'<div class="popup-content">'+g.html(h)+"</div>"),g.css(h,{position:"absolute",top:"-99999px",left:"-99999px"}),g.addClass(h,"tb-shop-popup-content"),g.show(h);var j=g.height(g.get(".popup-content",h));if(j>i)var k=new b.Popup({prefixCls:"",srcNode:h,trigger:e,triggerType:"mouse",align:{node:d,points:["tr","tl"],offset:[0,0]},visible:!1,zIndex:1e8});else k=new b.Popup({prefixCls:"",srcNode:h,trigger:e,triggerType:"mouse",align:{node:e,points:["tr","tl"],offset:[0,0]},visible:!1,zIndex:1e8})}else k=j>i?new b.Popup({srcNode:h,trigger:e,triggerType:"mouse",align:{node:d,points:["tr","tl"],offset:[0,0]},visible:!1,zIndex:1e8}):new b.Popup({srcNode:h,trigger:e,triggerType:"mouse",align:{node:e,points:["tr","tl"],offset:[0,0]},visible:!1,zIndex:1e8})}}var e=this,f=g.create("<div class='skin-box-bd'></div>"),h=g.create("<div class='tshop-pbsm-shop-nav-ch'></div> ");g.append(f,h),g.append(h,"#content"),g.css(f,"width","0"),g.css(f,"height","0");var i=g.query(".popup-trigger",e._mod);a.each(i,function(c,d){var e=g.parent(c,".popup-container"),h=g.get(".popup-content",e);g.append(h,f);var i=h;if(a.version.indexOf("1.4")>=0){g.hide(i),g.removeClass(i,"popup-content"),g.html(i,'<div class="popup-content">'+g.html(i)+"</div>"),g.addClass(i,"tb-shop-popup-content popup-hidden overlay-hidden"),g.css(i,{position:"absolute",top:"-99999px",left:"-99999px",zIndex:1e8}),g.show(i);var j=new b.Popup({prefixCls:"",srcNode:i,trigger:c,triggerType:"mouse",align:{node:e,points:["bl","tl"],offset:[0,0]},visible:!1,zIndex:1e8})}else j=new b.Popup({prefixCls:"",srcNode:i,trigger:c,triggerType:"mouse",align:{node:e,points:["bl","tl"],offset:[0,0]},visible:!1,zIndex:1e8})});var j=g.query(".fst-cat-hd",f);c()},_bindEvt:function(){},_setInherentStyle:function(){var a=this;g.css(a._mod,"display","block"),g.css(a._mod,"visibility","visible")},_fixMaxHeight:function(){var a=this;new c(a._mod,{maxHeight:!0,maxHeightValue:150}),new c(g.get("#hd"),{maxHeight:!0,maxHeightValue:150}),g.css(".tshop-pbsm-shop-custom-banner","position","relative")}}),d.selector=".tshop-pbsm-shop-nav-ch",d},{requires:["overlay","wangpu/decoration/compatible"]});KISSY.add("modules/shop/custom-banner/index",function(a){function b(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var a=KISSY;a.Event,a.DOM;return a.augment(b,{_init:function(){a.log("TshopPbsmShopCustomBanner init start")}}),b.selector=".tshop-pbsm-shop-banner",b});KISSY.add("modules/shop/main-slide/index",function(a){function b(b){var c=this;if(c._mod=b.mod,c._mod){a.log("TshopPbsmShopMainSlide init start"),c._init(),c.prevBtn=d.get(".prev-btn",c._mod),c.nextBtn=d.get(".next-btn",c._mod);var e=c.getCurrentStyle(d.get(".slide-box",c._mod),"height"),f=(e-c.getCurrentStyle(d.get(".slide-triggers",c._mod),"height")-c.getCurrentStyle(c.prevBtn,"height"))/2;c.prevBtn.style.top=(f>0?parseInt(f,10):0)+"px",c.nextBtn.style.top=(f>0?parseInt(f,10):0)+"px",a.UA.ie&&6==a.UA.ie&&(d.get(".slide-box",c._mod).className=d.get(".slide-box",c._mod).className),a.log("TshopPbsmShopMainSlide init end")}}var a=KISSY,c=a.Event,d=a.DOM;return a.augment(b,{_init:function(){var a=this;a.disBtn()},disBtn:function(){var a=this,b=d.get(".slide-box",a._mod),e=d.get(".prev-btn",a._mod),f=d.get(".next-btn",a._mod);c.on(b,"mouseenter",function(){d.addClass(e,"play"),d.addClass(f,"play")}),c.on(b,"mouseleave",function(){d.removeClass(e,"play"),d.removeClass(f,"play")}),c.on(e,"mouseenter",function(){d.addClass(e,"hover-pre")}),c.on(e,"mouseleave",function(){d.removeClass(e,"hover-pre")}),c.on(f,"mouseenter",function(){d.addClass(f,"hover-next")}),c.on(f,"mouseleave",function(){d.removeClass(f,"hover-next")})},render:function(a){},getCurrentStyle:function(a,b){var c=this,d="";return b=c.transToHump(b),d=window.getComputedStyle?window.getComputedStyle(a,null)[b]:a.currentStyle[b],parseInt(d,10)?parseInt(d,10):0},transToHump:function(a){return a.replace(/-([a-z])/gi,function(a,b){return b.toUpperCase()})}}),b.selector=".tshop-pbsm-shop-main-slide",b});KISSY.add("modules/shop/friend-link/index",function(a){function b(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var a=KISSY,c=a.Event,d=a.DOM;return a.augment(b,{_init:function(){a.log("TshopPbsmShopFriendLink init start");var b=this,e=d.query(".cat",b._mod);c.on(e,"mouseenter",function(a){var b=a.target;d.hasClass(a.target,"cat")||(b=d.parent(a.target,".cat")),d.addClass(b,"cat-hover")}),c.on(e,"mouseleave",function(a){var b=a.target;d.hasClass(a.target,"cat")||(b=d.parent(a.target,".cat")),d.removeClass(b,"cat-hover")}),a.log("TshopPbsmShopFriendLink init end")}}),b.selector=".tshop-pbsm-shop-friend-link",b});KISSY.add("modules/shop/item-cates/index",function(a){function b(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function c(b,c){var f=[],g=a.UA.ie;g&&6===g&&a.each(b,function(b){f=e.query(b.selector,c),a.each(f,function(a){d.on(a,"mouseenter",function(a){e.addClass(this,b.hClass)}),d.on(a,"mouseleave",function(a){e.removeClass(this,b.hClass)})})})}var a=KISSY,d=a.Event,e=a.DOM;return a.augment(b,{_init:function(){a.log("TshopPbsmShopItemCates init start");var b=this;b._catHighlight(),b._bindEvt(),c([{selector:".cat-hd",hClass:".cat-hd-hover"}],b._mod),a.log("TshopPbsmShopItemCates init end")},_catHighlight:function(){var b=e.get("#J_TSelectedMenuInfo");if(b){var c=a.JSON.parse(e.val(b)).selectedMenu,d=e.query(".cat-hd",self._mod),f=e.get(".cat-selected",self._mod);if(f&&e.removeClass(f,"cat-selected"),""==c.childCatId||""==c.catId)return;if(c.childCatId==c.catId){for(var g=0;g<d.length;g++)if(e.attr(d[g],"data-cat-id")==c.catId){e.addClass(d[g],"cat-selected");break}}else for(var g=0;g<d.length;g++)if(e.attr(d[g],"data-cat-id")==c.childCatId){e.addClass(d[g],"cat-selected");break}}},_bindEvt:function(){d.on(".cat-name","click",function(a){var b=e.get(a.currentTarget),c=e.parent(b,".cat-hd"),d=e.get(".cat-selected",self._mod);d&&e.removeClass(d,"cat-selected"),c&&!e.hasClass(c,"cat-selected")&&e.addClass(c,"cat-selected")})}}),b.selector=".tshop-pbsm-shop-item-cates",b});KISSY.add("modules/shop/top-list/index",function(a,b){function c(a){var b=this;b._mod=a.mod,b._mod&&(b.collectLoaded=!1,b.tabItems=[],b.tabItems[0]=e.parent(e.get(".J_CollectTab",b._mod),"li"),b.tabItems[1]=e.parent(e.get(".J_SaleTab",b._mod),"li"),b.panels=[],b.panels[0]=e.get("div.collection",b._mod),b.panels[1]=e.get("div.sale",b._mod),b.showMoreBtns=[],b.showMoreBtns[0]=e.get(".hotkeep_desc",b._mod),b.showMoreBtns[1]=e.get(".hotsell_desc",b._mod),b._init())}var a=KISSY,d=a.Event,e=a.DOM;a.all;return a.augment(c,{_init:function(){a.log("TshopPbsmShopTopList init start");var b=this;b.topLists=e.query(c.selector),b.rIndex=a.indexOf(b._mod,b.topLists),b.idx=0,b._renderPanels(),b._bindEvent(),a.log("TshopPbsmShopTopList init end")},_renderPanels:function(){function b(){a.each(c.panels,function(a){e.addClass(a,"disappear")}),a.each(c.showMoreBtns,function(a){e.addClass(a,"disappear")})}var c=this,d=!1;a.each(c.tabItems,function(a,f){e.hasClass(a,"selected")&&(d=!0,b(),e.removeClass(c.panels[f],"disappear"),e.removeClass(c.showMoreBtns[f],"disappear"),c.idx=f,e.hasClass(a,"J_Collect")&&c._initCollectBox(e.attr(a,"data-geturl")))}),0==d&&(e.addClass(c.tabItems[0],"selected"),b(),e.removeClass(c.panels[0],"disappear"),e.removeClass(c.showMoreBtns[0],"disappear"),c.idx=0)},_initCollectBox:function(c){var d=this,c=c+"&jsoncallback=window.shop.rankCallback&index="+d.rIndex;e.html(d.panels[0],'<img class="loading-img" src="//img.alicdn.com/tps/i2/T16WJqXaXeXXXXXXXX-32-32.gif" />'),d.collectLoaded=!0,window.shop=window.shop||{},window.shop.rankCallback=function(c){if(void 0!=c.index){var f=d.topLists[c.index],g=e.get(".collection",f),h='<li class="{{odd_even}} {{is_first_last}}"><div class="ranking"><span>{{idx}}</span></div><div class="more"><a target="_blank" href="{{linkUrl}}"><img class="hover-show" src="{{imgUrl}}_120x120.jpg"></a></div><div class="img"><a href="javascript:void(0);"><img  class="hover-show" src="{{imgUrl}}_120x120.jpg" alt="\u5546\u54c1\u56fe\u7247"></a></div><div class="detail"><p class="desc"><a href="{{linkUrl}}" title="{{productName}}" target="_blank">{{productName}}</a></p><p class="price"><span class="symbol">&yen;</span><span >{{price}}</span></p><p class="sale">\u5df2\u6536\u85cf<span class="sale-count">{{sellOffCount}}</span>\u7b14</p></div></li>',i="<ul>";a.each(c.items,function(a,d){var e="";0==d?e="first":d==c.items.length-1&&(e+="last"),i+=b(h).render({odd_even:d%2==0?"even":"odd",idx:d+1,linkUrl:a.link,imgUrl:a.imageUrl,price:(parseInt(100*a.price)/100).toFixed(2),productName:a.title,sellOffCount:a.collectorCount,is_first_last:e})}),i+="</ul>",e.html(g,i)}},a.getScript(c)},_bindEvent:function(){var b=this;a.each(b.tabItems,function(a,c){d.on(a,"mouseover",function(d){b.idx!=c&&(b.idx=c,e.toggleClass(b.tabItems[0],"selected"),e.toggleClass(b.tabItems[1],"selected"),e.toggleClass(b.panels[0],"disappear"),e.toggleClass(b.panels[1],"disappear"),e.toggleClass(b.showMoreBtns[1],"disappear"),e.toggleClass(b.showMoreBtns[1],"disappear"),e.hasClass(a,"J_Collect")&&b.collectLoaded===!1&&b._initCollectBox(e.attr(a,"data-geturl")))})});var c=setTimeout(function(){}),f=setTimeout(function(){}),g=10,h=100,i=null,j=setTimeout(function(){}),k=null;d.on(b._mod,"mouseover mouseout",function(a){var b=a.target;"mouseover"==a.type?("IMG"==b.tagName&&(clearTimeout(f),c=setTimeout(function(){var a=e.parent(b,"LI");e.removeClass(i,"show-more"),e.addClass(a,"show-more"),i=a},g)),("LI"==b.tagName||e.parent(b,"LI"))&&(clearTimeout(j),e.removeClass(k,"hover"),k="LI"==b.tagName?b:e.parent(b,"LI"),e.addClass(k,"hover"))):"mouseout"==a.type&&("IMG"==b.tagName&&(clearTimeout(c),f=setTimeout(function(){var a=e.parent(b,"LI");e.removeClass(a,"show-more")},h)),("LI"==b.tagName||e.parent(b,"LI"))&&(j=setTimeout(function(){e.removeClass(k,"hover")},50)))})}}),c.selector=".tshop-pbsm-shop-top-list",c},{requires:["wangpu/gallery/template"]});KISSY.add("modules/component/taojinbi/index",function(a,b,c,d,e){function f(a){var b=this;b.config=a,b.sellerId=a.sellerId,b.token=a.token,b.init()}var g=location.host.indexOf("daily.")>=0,h=g?"//api-taojinbi.daily.taobao.net":"//api-taojinbi.taobao.com",i=h+"/json/signin_status.htm",j=h+"/json/signin_detail.htm",k=h+"/json/signin.htm",l=g?"//site.daily.taobao.net":"//site.taobao.com",m=l+"/page-25130.htm",n="<div class='J_SigninBox tb-signin-box'>             <div class='signin-wrap'>             {{#if isSuccess}}             <h3>\u606d\u559c\u4f60\u83b7\u5f97<em>{{succ_coins}}</em>\u4e2a\u6dd8\u91d1\u5e01</h3>             <p>\u4f60\u5df2\u7b7e\u5230<em>{{sign_days}}</em>\u5929\uff0c\u5171\u83b7\u5f97\u638c\u67dc<em>{{sign_coin_sum}}</em>\u4e2a\u6dd8\u91d1\u5e01\u3002</p>             <p>\u8fde\u7eed\u7b7e\u5230<em>{{act_ext_days}}</em>\u5929\uff0c\u8fd8\u53ef\u4ee5\u989d\u5916\u83b7\u5f97<em>{{act_ext_num}}</em>\u4e2a\uff0c\u52a0\u6cb9\u54e6\uff01</p>                 {{#if act_start_time}} <p>\u6d3b\u52a8\u65f6\u95f4\uff1a{{act_start_time}} - {{act_end_time}}</p>             {{/if}}             {{else}}             <h3>{{err_msg}}</h3>             {{#if err_code===0-4}}             <p>\u638c\u67dc\u7ed9\u4e86\u54b1\u91d1\u5e01\uff0c\u54b1\u53bb<a href='{{shopUrl}}'>\u638c\u67dc\u5e97\u94fa</a>\u901b\u901b{{#if dq_act_status}}\uff0c\u5168\u5e97\u6dd8\u91d1\u5e01\u62b5\u94b1\u6d3b\u52a8\u8fdb\u884c\u4e2d\uff01{{/if}}</p>             {{else}}             <p>\u6765\u90fd\u6765\u4e86\uff0c\u53bb<a href='{{shopUrl}}'>\u638c\u67dc\u5e97\u94fa</a>\u901b\u901b{{#if dq_act_status}}\uff0c\u5168\u5e97\u6dd8\u91d1\u5e01\u62b5\u94b1\u6d3b\u52a8\u8fdb\u884c\u4e2d\uff01{{/if}}</p>             {{/if}}             {{/if}}             {{#if coin_sum}}             <p class='summary'>\u4f60\u7684\u6dd8\u91d1\u5e01\u603b\u8ba1<em>{{coin_sum}}</em>\u4e2a\uff0c\u6700\u5c11\u53ef\u62b5<em>{{coin_sum_money}}</em>\u5143</p>             {{/if}}             <p class='ctrl-btn'>             <a href='{{shopUrl}}' class='J_THuaJinBi'>\u901b\u5e97\u94fa\u82b1\u91d1\u5e01</a>             </p>             </div>             <i class='close-btn'>&#9587;</i>             </div>";return a.augment(f,{init:function(){},signin:function(a){var b=this,c=k;b._checkLogin(function(){d({url:c,dataType:"jsonp",data:{seller_id:b.sellerId,_tb_token_:b.token},success:function(c){b._applyHandler(c,a)},error:function(){b._signFailHandler.call(b)}})})},getActStatus:function(b){var c=this,d=m;a.jsonp(d,{uid:c.sellerId},b)},isSign:function(b){var c=this;if(!TB.Global.isLogin())return void b({has_signed:!1,msg:"\u7528\u6237\u672a\u767b\u5f55"});var d=i;a.jsonp(d,{seller_id:c.sellerId},b)},signDetail:function(b,c,d){var e=this;if(!TB.Global.isLogin())return void b({msg:"\u7528\u6237\u672a\u767b\u5f55"});var f=j;a.jsonp(f,{seller_id:e.sellerId,from:c,to:d},b)},_checkLogin:function(a){TB.Global.use("fn-login",function(b,c){c.Mini.popup(a)})},_applyHandler:function(b,c){var d=this,e=b.isSuccess,f=a.clone(b);if(b.act_start_time){var g={year:"numeric",month:"numeric",day:"numeric"};f.act_start_time=new Date(b.act_start_time).toLocaleDateString("zh-Hans",g),f.act_end_time=new Date(b.act_end_time).toLocaleDateString("zh-Hans",g)}d.success=e,f.shopUrl=d.config.shopUrl,d._popup(f),c(b)},_signFailHandler:function(){var a=this,b={err_msg:"\u7cfb\u7edf\u9003\u547d\u53bb\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"};a._popup(b)},_popup:function(a){var d=this;d.popupEl&&b.remove(d.popupEl),d.popupEl=b.create(new e(n).render(a));var f=b.get(".close-btn",d.popupEl);c.on(f,"click",function(){b.hide(d.popupEl)}),b.append(d.popupEl,"body")}}),f},{requires:["dom","event","ajax","xtemplate","./default.css"]}),KISSY.add("modules/shop/activity-list/apply",function(a,b){function c(a){var b=this;b.config=a,b.type=a.type?a.type:"hongbao",b.activityId=a.activityId,b.showItems=void 0!=a.showItems?a.showItems:!0,b.sellerId=a.sellerId,b.daily=void 0!=a.daily?a.daily:!1,b.applyChannel=a.applyChannel,b.isShop=a.isShop?!0:!1,b.token=a.token?a.token:"";var c="taoquan.taobao.com";b.daily&&(c="taoquan.daily.taobao.net"),"hongbao"==b.type?(b.cburl=a.cburl,b.applyUrl="//"+c+"/coupon/shopbonus/buyer_share_apply.htm"):b.applyUrl="//"+c+"/coupon/itemCoupon/item_coupon_promotion_apply.htm",b.init()}var a=KISSY,d=a.DOM,e=a.Event,f=function(a){return this instanceof f?(a=a||{},this.cburl=a.cburl,this.daily=!!a.daily,this.from=a.from,f.__INSTANCE__=this,this.available=!0,void this._init()):new f(a)};return a.augment(f,e.Target,{_init:function(){return a.namespace("Member.Weibo",!0),window.Member.Weibo.Bind=f,this.from&&this.cburl&&0===this.cburl.indexOf(window.location.protocol+"//"+window.location.host)?void(this.url="//member1."+(this.daily?"daily.taobao.net":"taobao.com")+"/member/fresh/weibo_bind_management.htm"):(this.available=!1,this.fire("failure"),void alert("ERROR: no from/cburl param or domain not match."))},show:function(){return this.available?(this.o=new b.Dialog({prefixCls:"applyCoupon-",width:400,headerContent:"\u9886\u53d6\u7ea2\u5305\u9700\u8f6c\u53d1\u6d3b\u52a8\u5fae\u535a",bodyContent:'<iframe src="'+this.url+"?cburl="+this.cburl+"&from="+this.from+'" style="display:block;width:400px;height:355px;" scrolling="no" frameborder="0" allowtransparency="true"></iframe>',closable:!0,closeAction:"destroy",mask:!1,zIndex:1e9}),this.o.render(),this.o.center(),this.o.get("el").all(".applyCoupon-ext-close-x").html("\xd7"),this.o.show(),this._bindEvent(),this):this},hide:function(){return this.available?(this.o&&this.o.destroy(),this.o=null,this.fire("hide"),this):this},_bindEvent:function(){this.on("success failure",function(){this.hide()},this),this.o&&this.o.on("hide",function(){this.fire("hide"),this.fire("destroy")},this)}}),a.augment(c,e.Target,{init:function(){var a=this,b=!1;if(-1==window.location.href.indexOf("taobao"))b=!0;else{var c=function(a){var b,c;return(c=String(document.cookie).match(new RegExp("(?:^| )"+a+"(?:(?:=([^;]*))|;|$)")))&&(b=c[1]?decodeURIComponent(c[1]):""),b};b=!!(c("_l_g_")&&c("_nk_")||c("ck1")&&c("tracknick")||c("lgc"))}a.initLogin(b)},normalize:function(a){var b=this;return a=b.daily?a.replace("a.tbcdn.cn","assets.daily.taobao.net").replace("taobao.com","daily.taobao.net"):a.replace("assets.daily.taobao.net","a.tbcdn.cn").replace("daily.taobao.net","taobao.com")},initLogin:function(b){var c=this;if(0==b){goldlog.send("//ga.mmstat.com/tbtwlact.2.2",{});var f=c.normalize("//login.taobao.com/member/login.jhtml?style=mini&is_ignore=false&full_redirect=true"),g='<div class="sns-login-content"><div class="sns-login-wrap"><div class="sns-login-title">\u6dd8\u5b9d\u4f1a\u5458</div><iframe width="330" height="285" frameborder="0"scrolling="no" src="'+f+'&redirect_url={redirectUrl}"></iframe></div><s style="display:{closeBtn}" class="sns-close-btn">&times;</s></div>',h=".sns-close-btn {    color:#9c9c97;    text-decoration:none;    font-size:22px;    position:absolute;    right:12px;    top:5px;    cursor:pointer;}.sns-popup-login {	position:absolute;}.sns-login-content {   border-radius: 3px;	border:3px solid #d5d5d5;	background-color:#FAFAFA;}.sns-login-wrap {   width: 330px;    border: 1px solid #aaa;   overflow: hidden; }.sns-login-title {   background: #f2f2f2;   height: 35px;   line-height: 35px;   font-size: 14px;   font-weight: 700;   color: #000;   padding-left: 15px;   margin-bottom: 25px;}";d.addStyleSheet(h);var i=new a.Overlay({elCls:"sns-popup-login",content:a.substitute(g,{closeBtn:"block",redirectUrl:encodeURIComponent(window.location.href)}),zIndex:1e9,mask:!1,align:{node:null,points:["cc","cc"],offset:[0,0]}});i.render(),i.show();var j;j=a.isFunction(i.get)?i.get("el").getDOMNode():i.container,e.on(d.get(".sns-close-btn",j),"click",function(){i.destroy()})}else a.io({url:c.applyUrl,data:{activityId:c.activityId,sellerId:c.sellerId,applyChannel:c.applyChannel},cache:!1,dataType:"jsonp",success:function(a){if(c.shopUrl=a.shopUrl,c.shopName=a.shopName,c.amount=a.amount,c.startTime=a.startTime,c.endTime=a.endTime,c.startFee=a.startFee,c.discount=a.discount,c.activeCenter=a.activeCenter,"true"==a.success)c.renderPop(a);else{if("NOT_LOGIN"==a.code)return void c.initLogin(!1);if("NOT_BIND_WEIBO"==a.code)return void c.weiboBind();if("SHARE_WEIBO"==a.code)return void c.share();if("PARAM_VALID"==a.code)return void alert(a.msg);"APPLY_ERROR"==a.code&&c.renderPop(a)}}})},weiboBind:function(){goldlog.send("//ga.mmstat.com/tbtwlact.2.3",{});var a=this;f({cburl:a.cburl,daily:a.daily,from:"sns"}).show().on("success",function(){a.share(),goldlog.send("//ga.mmstat.com/tbtwlact.2.8",{})}).on("failure",function(){goldlog.send("//ga.mmstat.com/tbtwlact.2.8",{})})},_getValue:function(b){var c=a.trim(d.attr(b,"placeholder")),e=a.trim(b.value),f=d.attr(b,"maxlength");return c===e?"":f&&e>=f?e.substr(0,f):e},encodeGBK:function(a){function b(a){return a?window.ActiveXObject?(execScript('SetLocale "zh-cn"',"vbscript"),a.replace(/[\d\D]/g,function(a){return window.vbsval="",execScript('window.vbsval=Hex(Asc(" '+a+'"))',"vbscript"),"%"+window.vbsval.slice(0,2)+"%"+window.vbsval.slice(-2)})):(c.src="//www.atpanel.com/jsclick?globaljs=1&separator="+a,c.src.split("&separator=").pop()):""}var c=document.createElement("img");return a.replace(/([^\x00-\xff]+)|([\x00-\xff]+)/g,function(a,c,d){return b(c)+encodeURIComponent(d||"")})},share:function(){goldlog.send("//ga.mmstat.com/tbtwlact.2.1",{});var c=this,d=a.Cookie.get("_nk_")||a.Cookie.get("lgc");void 0!=d&&(d=a.fromUnicode(d)),c.shopName||(c.shopName="");var e='<div class=\'apply-coupon-content clearfix\'><div class="sns-content">\n<div class="article">\n    <div class="selected">\n        <span class="title">\u540c\u6b65\u5230:</span>\n        <i class="i-sina"></i>\n    </div>\n    <div class="item">\n        <div class="share-ipt">\n            <div class="user">\n                <img src="//wwc.taobaocdn.com/avatar/getAvatar.do?userNick='+c.encodeGBK(d).toLowerCase()+'&width=80&height=80&type=sns" width="40" height="40">\n                <span class="user-nick">'+d+'</span>\n            </div>\n            <div class="entry">\n                <textarea maxlength="140" class="J_SnsShareComment">#1212\u5e97\u94fa\u7ea2\u5305\u5927\u6d3e\u9001#\u8f7b\u8f7b\u677e\u677e\u5c31\u9886\u5230'+c.amount+"\u5757\u94b1\uff0c\u597d\u55e8\u68ee\uff01\uff01\u4f60\u60f3\u8981\u5417\uff1f"+c.shopName+'\u5e97\u94fa\u6b63\u5728\u53d1\u7ea2\u5305\uff0c\u5c0f\u4f19\u4f34\u4eec\u90fd\u62a2\u75af\u4e86\uff0c\u518d\u4e0d\u53bb\u5c31\u6ca1\u5566\uff01</textarea>\n            </div>\n            <p class="count hidden">\u8fd8\u53ef\u4ee5\u8f93\u5165 <em class="J_Count">135</em> \u4e2a\u5b57</p><s></s></div>\n    </div>\n</div>\n<div class="sns-share-widget-footer">\n    <div class="operate">\n        <a class="continue J_Continue J_Submit" href="">\u7acb\u5373\u5206\u4eab</a>\n        <a class="cancel J_Cancel J_Close" href="">\u53d6\u6d88</a>\n    </div>\n    <div class="J_ExtraInfo extra-info"></div>\n</div>\n</div></div>';c.amount||(e='<div class=\'apply-coupon-content clearfix\'><div class="sns-content">\n<div class="article">\n    <div class="selected">\n        <span class="title">\u540c\u6b65\u5230:</span>\n        <i class="i-sina"></i>\n    </div>\n    <div class="item">\n        <div class="share-ipt">\n            <div class="user">\n                <img src="//wwc.taobaocdn.com/avatar/getAvatar.do?userNick='+c.encodeGBK(d).toLowerCase()+'&width=80&height=80&type=sns" width="40" height="40">\n                <span class="user-nick">'+d+'</span>\n            </div>\n            <div class="entry">\n                <textarea maxlength="140" class="J_SnsShareComment">#1212\u5e97\u94fa\u7ea2\u5305\u5927\u6d3e\u9001#\u8f7b\u8f7b\u677e\u677e\u5c31\u9886\u5230\u7ea2\u5305\uff0c\u597d\u55e8\u68ee\uff01\uff01\u4f60\u60f3\u8981\u5417\uff1f'+c.shopName+'\u5e97\u94fa\u6b63\u5728\u53d1\u7ea2\u5305\uff0c\u5c0f\u4f19\u4f34\u4eec\u90fd\u62a2\u75af\u4e86\uff0c\u518d\u4e0d\u53bb\u5c31\u6ca1\u5566\uff01</textarea>\n            </div>\n            <p class="count hidden">\u8fd8\u53ef\u4ee5\u8f93\u5165 <em class="J_Count">135</em> \u4e2a\u5b57</p><s></s></div>\n    </div>\n</div>\n<div class="sns-share-widget-footer">\n    <div class="operate">\n        <a class="continue J_Continue J_Submit" href="">\u7acb\u5373\u5206\u4eab</a>\n        <a class="cancel J_Cancel J_Close" href="">\u53d6\u6d88</a>\n    </div>\n    <div class="J_ExtraInfo extra-info"></div>\n</div>\n</div></div>');var f=new b.Dialog({prefixCls:"applyCoupon-",zIndex:1e9,mask:!1,headerContent:"\u9886\u53d6\u7ea2\u5305\u9700\u8f6c\u53d1\u6d3b\u52a8\u5fae\u535a",bodyContent:e,closeable:!0,closeAction:"destroy"});f.render(),f.get("el").all(".applyCoupon-ext-close-x").html("\xd7"),f.center(),f.show(),f.get("el").one("textarea").on("focus",function(b){a.all(b.target).css("color","#000")}),f.get("el").one("textarea").on("blur",function(b){a.all(b.target).css("color","#999")}),c._maxlength(f.get("el").getDOMNode()),f.get("el").one(".J_Close").on("click",function(a){a.preventDefault(),goldlog.send("//ga.mmstat.com/tbtwlact.2.7",{}),f.destroy()}),f.get("el").one(".applyCoupon-ext-close-x").on("click",function(a){goldlog.send("//ga.mmstat.com/tbtwlact.2.7",{})}),f.get("el").one(".J_Submit").on("click",function(b){b.preventDefault(),goldlog.send("//ga.mmstat.com/tbtwlact.2.6",{}),a.io({url:c.applyUrl,data:{activityId:c.activityId,sellerId:c.sellerId,applyChannel:c.applyChannel,title:encodeURIComponent("\u6dd8\u5b9d\u7f51\u53cc\u5341\u4e8c\u5e97\u94fa\u7ea2\u5305\u6d3b\u52a8"),comment:encodeURIComponent(c._getValue(f.get("el").all(".J_SnsShareComment").getDOMNode())),link:c.activeCenter},dataType:"jsonp",cache:!1,success:function(a){if(f.destroy(),"true"==a.success)goldlog.send("//ga.mmstat.com/tbtwlact.2.5",{activityId:c.activityId,sellerId:c.sellerId,applyChannel:c.applyChannel}),c.renderPop(a);else{if("PARAM_VALID"==a.code)return void alert(a.msg);"APPLY_ERROR"==a.code&&c.renderPop(a)}}})})},hasParam:function(a){return a.indexOf("?")>-1?a+"&":a+"?"},_maxlength:function(a){var b="maxLength"in document.createElement("textarea");if(!b){var c=a.getAttribute("maxlength");e.on(a,"valuechange",function(b){a.value.length>c&&(a.value=a.value.substring(0,c))})}},renderPop:function(c){var f=this,g="",h="",i='<div style="margin-top: 13px;color: #666;"><a class="J_close">\u786e \u5b9a</a>',j="";"hongbao"==f.type?(j="1223.1.10",goldlog.send("//ga.mmstat.com/tbtwlact.1.1",{})):(j="1223.2.10",goldlog.send("//ga.mmstat.com/tbtwlact.3.1",{}));var k='<div class="applyCouponResult"><div class="close">\xd7</div> <div class="results">';if("true"==c.success){goldlog.send("//ga.mmstat.com/shopcoupons.1.* ",{});var l=!1;if(f.fire("success"),k+=' <div class="label suc"></div>',c.startTime=c.startTime.slice(0,10).replace("-",".").replace("-","."),c.endTime=c.endTime.slice(0,10).replace("-",".").replace("-","."),"hongbao"==f.type){var m="";c.amount&&(m='<span class="red"><span class="money">\uffe5</span>'+c.amount+"</span>"),g="\u606d\u559c\uff0c\u60a8\u5df2\u6210\u529f\u9886\u53d6"+m+'\u5e97\u94fa\u7ea2\u5305\u3002<a target="_blank" href="//taoquan.taobao.com/framework/got_bonus.htm?scm=1223.1.10.1&tabIndex=5" style="font-size: 12px">\u67e5\u770b></a></div>',g+='<div class="date">\u4f7f\u7528\u65f6\u95f4\uff1a'+c.startTime+"-"+c.endTime+" \u5168\u5e97\u901a\u7528</div>",h="<div>",c.leftCount&&(h+='\u60a8\u4eca\u5929\u8fd8\u80fd\u9886<span class="red">'+c.leftCount+"</span>\u5f20")}else{var m="";c.startFee&&c.discount&&(m='<span class="red">\u6ee1'+c.startFee+"\u51cf"+c.discount+"\u5143</span>"),g="\u606d\u559c\uff0c\u60a8\u5df2\u6210\u529f\u9886\u53d6"+m+'\u5546\u54c1\u4f18\u60e0\u5238\u3002</div><div class="date">\u4f7f\u7528\u65f6\u95f4\uff1a'+c.startTime+"-"+c.endTime,c.shopUrl&&(g+='<a href="'+f.hasParam(c.shopUrl)+"scm="+j+'.4" target="_blank">\u67e5\u770b\u9002\u7528\u5b9d\u8d1d</a>'),g+="</div>"}l&&(i+='<span style="*vertical-align: bottom"><input checked="checked" class="J_collect" type="checkbox">\u6536\u85cf\u8be5\u5e97</span>')}else goldlog.send("//ga.mmstat.com/shopcoupons.2.* ",{}),k+='<div class="label fail"></div>',f.fire("fail"),g=c.msg+"</div>","hongbao"==f.type&&(h='<a target="_blank" href="//taoquan.taobao.com/framework/got_bonus.htm?scm=1223.1.10.1&tabIndex=5" style="font-size: 12px">\u67e5\u770b\u5df2\u9886\u5230\u7684\u5e97\u94fa\u7ea2\u5305></a>');i+="</div>","hongbao"!=f.type&&(!f.isShop&&c.activeCenter&&(g+='<div><a href="'+f.hasParam(c.activeCenter)+"scm="+j+'.1" target="_blank">\u67e5\u770b\u8be5\u5e97\u66f4\u591a\u4f18\u60e0</a></div>'),h=' <div>\u67e5\u770b\u5df2\u9886\u5546\u54c1\u4f18\u60e0\u5238\uff1a<a href="//taoquan.taobao.com/framework/got_bonus.htm?tabIndex=2&display=true&tabDomId=itemCouponTab&scm='+j+'.2" target="_blank">\u6211\u7684\u4f18\u60e0\u4fe1\u606f</a></div>'),k+=' <div class="result-text"><div class="result">'+g+'<div class="gray">'+h+" </div>"+i+"</div> </div> ",k+="</div>";var n=new b.Popup({prefixCls:"applyCoupon-",zIndex:1e9,mask:!1,content:k,closeable:!0,closeAction:"destroy"});n.render(),n.center(),n.show(),e.on(d.get(".close",n.get("el")),"click",function(a){n.destroy()}),e.on(d.get(".J_close",n.get("el")),"click",function(b){var e=d.get(".J_collect",n.get("el"));if(e&&d.prop(e,"checked")){var g;g=f.daily?"//favorite.daily.taobao.net/json/addCollectionForAll.htm":"//favorite.taobao.com/json/addCollectionForAll.htm",a.io({url:g,data:{shopId:c.shopId,favType:0},dataType:"jsonp",cache:"false"})}n.destroy()})}}),c},{requires:["overlay","./apply.css"]}),KISSY.add("modules/shop/activity-list/index",function(a,b,c,d,e){function f(a){var b=this;b._mod=a.mod,b._mod&&(b.activityList=h.query(f.selector),b.actBabySwitch=h.query(".act-baby-switchable",b._mod),b.actCouponItems=h.query(".act-coupon-item",b._mod),b.actSwitchalbe=[],k=g_config.sellerId,b._init())}var a=KISSY,g=a.Event,h=a.DOM,i=(a.all,window.location.host.indexOf("taobao.com")<0?!0:!1),j=g_config&&g_config.shopId,k="";return a.augment(f,{_init:function(){a.log("TshopPbsmShopActivityList init start");var b=this;b._initSlide(),b._initCoupon(),b._bindEvent(),a.log("TshopPbsmShopActivityList init end")},_bindEvent:function(){var b=this;a.each(b.actBabySwitch,function(a,c){if(b.actBabySwitch[c]){var d=h.query(".scrollable-switch-trigger",a);g.on(a,"mouseover mouseout",function(a){h.toggleClass(d,"act-hidden")})}}),g.on(b._mod,"click",function(a){var c=h.get(a.target);if(h.hasClass(c,"act-coupon-btn")){if(a.preventDefault(),h.hasClass(c,"disable"))return;b._initCoupon(function(){b._takeCoupon(c)})}else if(h.hasClass(c,"act-tjb-btn")){if(a.preventDefault(),h.hasClass(c,"disable")||h.hasClass(c,"taking"))return;h.addClass(c,"taking"),b._takeCoin(c)}})},_takeCoin:function(b){a.use("tbc/mini-login/1.4.3/",function(a,c){c.show({type:"l"},function(){var a=new d({isDaily:i,sellerId:k,token:h.val("#J_TokenField"),shopUrl:"//shop"+j+".taobao.com"});a.signin(function(a){h.removeClass(b,"taking"),a.isSuccess&&(h.addClass(b,"disable"),h.html(b,"\u5df2\u9886\u53d6"))})})})},_takeCoupon:function(b){var c=1==h.attr(b,"bonus-type"),d=h.attr(b,"activity-id");a.use("tbc/mini-login/1.4.3/",function(a,f){f.show({type:"l"},function(){new e({type:c?"hongbao":"coupon",activityId:d,sellerId:k,daily:i,applyChannel:1}).on("success",function(){h.addClass(b,"disable"),h.html(b,"\u5df2\u9886\u53d6")}).on("fail",function(){})})})},_initCoupon:function(a){var b=this;b.actCouponItems.length>0&&a&&a()},_initSlide:function(){var b=this;a.each(b.actBabySwitch,function(a,c){b.actSwitchalbe[c]=1;var d=h.get(".ks-switchable-content",a),e=h.query(".scrollable-content",a);d&&e.length>1&&(b.actBabySwitch[c]=a,b._slide(a))})},_slide:function(a){var b=c.Carousel;new b(a,{effect:"scrollx",easing:"easeOutStrong",viewSize:[160],circular:!0,prevBtnCls:"act-prev",nextBtnCls:"act-next",autoplay:!0})}}),f.selector=".tshop-pbsm-shop-activity-list",f},{requires:["cookie","wangpu/gallery/switchable","modules/component/taojinbi/","./apply"]});KISSY.add("modules/shop/item-recommend/index",function(a,b){function c(a){this.elem=a}function d(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function e(a,b){var c=a.length,d=0,e=a.match(/[\u4E00-\u9FA5\uF900-\uFA2D]/g);null!=e&&(d+=e.length);var f=b-c-d;if(0>f){for(var g=0,h=a.substring(0,b),i=0;i<h.length&&(g+=/[\u4E00-\u9FA5\uF900-\uFA2D]/.test(h.charAt(i))?2:1,!(g>b));i++);return h.substring(0,i)+"\u2026"}return a}var a=KISSY,f=a.Event,g=a.DOM,h=a.all,i="disappear",j="success",k="warn",m="failure",n={"grid-m":{item3line1:[0,0,310,310],item4line1:[0,0,230,230],item5line1:[0,0,180,180],item7line1:[0,0,130,130]},"grid-m0":{item3line1:[0,0,310,310],item4line1:[0,0,230,230],item5line1:[0,0,180,180],item7line1:[0,0,130,130]},"grid-s5m0":{item3line1:[0,0,240,240],item30line1:[0,0,248,248],item4line1:[0,0,180,180]},"grid-m0s5":{item3line1:[0,0,240,240],item30line1:[0,0,248,248],item4line1:[0,0,180,180]},"grid-s5m0e5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-m0s5e5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-s5e5m0":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-e5s5m0":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-e5m0s5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-m0e5s5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"col-sub":{item1line1:[0,0,180,180]},"col-extra":{item1line1:[0,0,180,180]}};return a.mix(c.prototype,{val:function(b,c,d){a.isString(b)&&(d=void 0===d?!0:!!d,g.html(g.get(".text",this.elem),b),this.show(c),d&&this.hide(d))},loading:function(){return this.val("\u6b63\u5728\u5904\u7406\uff0c\u8bf7\u7a0d\u540e...",1,!1)},show:function(a){var b=this.elem;g.css(b,"opacity",1),g.removeClass(b,j),g.removeClass(b,k),g.removeClass(b,m),g.removeClass(b,i),1==a?g.addClass(b,j):2==a?g.addClass(b,k):0==a&&g.addClass(b,m)},hide:function(b){var c=this,d=c.elem;return!0===b?(c.timer&&c.timer.cancel(),void(c.timer=a.later(function(){var b={opacity:0},e=new a.Anim(d,b,.5,"easeIn",function(){g.addClass(d,i),c.timer=null});e.run()},3e3))):void g.addClass(d,i)}}),a.augment(d,{_init:function(){a.log("TshopPbsmShopItemRecommend init start");var b,c=this;b=function(){c._updateToken(),c._bindEvt(),c.fixHover([{selector:".item-wrap",hClass:"item-wrap-hover"}]),c._initItemRates(),c._fixMinMax(),a.log("TshopPbsmShopItemRecommend init end")},c._ABTestRequest(b)},_ABTestRequest:function(b){var c,d,e,f=this;return e=function(){return b(),!1},(c=g.attr(f._mod,"data-ald-rcmd"))?(d=JSON.parse(c),d&&d.url?void a.io({url:d.url,dataType:"jsonp",data:{refer:document.referrer||""},success:function(b){if(!b||!b.itemList||!b.itemList.length)return e();var c=g.get(".skin-box",f._mod),i=g.innerHeight(f._mod);g.css(f._mod,"height",i),g.css(c,"display","none");var j,k=g.query(".item",f._mod);if(j=g.get(".J_TItemRatesUrl")){var l=g.val(j),m=function(){var c=[];return a.each(b,function(a){c.push(a.id)}),c.join(",")}();l.replace(/itemIds=.*&/i,"itemIds="+m+"&"),g.val(j,l)}a.each(k,function(c,e){var f,i=h(c),j=h(c).attr("data-id");a.each(b.itemList,function(a){return a.id===j?(f=a,!1):void 0});var k=g.get("img",c),l=d.picSize?d.picSize:"310",m="_"+l+"x"+l+".jpg",n=f.img+m;g.attr(k,"data-ks-lazyload")?g.attr(k,"data-ks-lazyload",n):g.attr(k,"src",n),i.attr(".s-price")&&i.attr(".s-price",f.price),g.attr(c,"data-id",f.id),g.attr(g.query("a",c),"href",f.url),g.text(g.get(".item-name",c),f.title),g.text(g.get(".c-price",c),(d.showDiscount?f.price:f.marketPrice)||""),g.text(g.get(".sale-num",c),f.sellNum||0),g.text(g.get(".comment-num",c),f.commentNum||0)}),(new Image).src=b.acurl,g.css(f._mod,"height","auto"),g.css(c,"display","block"),e()},error:e}):e()):e()},_updateToken:function(){var b=this,c=g.get("#J_TokenField");if(c){var d=/_tb_token_=[^&].*/i,e="_tb_token_="+c.value,f=g.query(".J_TCollectItem",b._mod);a.each(f,function(a){var b=g.attr(a,"data-href");d.test(b)?g.attr(a,"data-href",b.replace(d,e)):g.attr(a,"data-href",b+=(-1!==b.lastIndexOf("&")?"&":"?")+e)})}},_bindEvt:function(){},fixHover:function(b){var c=this,d=[];a.each(b,function(b){d=g.query(b.selector,c._mod),a.each(d,function(c){f.on(c,"mouseenter",function(c){a.one(this).addClass(b.hClass)}),f.on(c,"mouseleave",function(c){a.one(this).removeClass(b.hClass)})})})},_bindItemCollectEvt:function(){var b=this,d=g.get(".items",b._mod);f.on(d,"click",function(b){var d=b.target;if(g.hasClass(d,"J_TCollectItem")){var e=d;a.io({url:g.attr(e,"data-href"),data:{itemSkuList:g.attr(e,"data-item-id")},dataType:"jsonp",success:function(a){var b,d;if(a.result.status)b="\u6536\u85cf\u6210\u529f",d=1;else{switch(a.result.message.errorCode){case 7:case 8:case 11:d=2;break;default:d=0}b=a.result.message.error}var f=new c(g.get(".J_TMsg",g.parent(e)));f.val(b,d)},error:function(a){var b=new c(g.get(".J_TMsg",g.parent(e)));b.val("\u64cd\u4f5c\u8d85\u65f6",0)}})}})},_initItemRates:function(){function b(){a.io({url:h.value,dataType:"jsonp",jsonp:"jsoncallback",type:"post",success:function(b){var c,f,h=b.batchQueryRateList,i=g.query(".item",d._mod);a.each(i,function(a){c=g.attr(a,"data-id");for(var b=0;b<h.length;b++)h[b].auctionNumId==c&&(f=g.get(".J_TRate",a),""==h[b].rateContent?g.text(f,"\u6682\u65e0\u8bc4\u8bba"):g.text(f,e(h[b].rateContent,72)))})},error:function(b){a.log("\u67e5\u8be2\u5b9d\u8d1d\u8bc4\u8bba\u5931\u8d25")}})}function c(){!d.isSendRate&&g.scrollTop(window)>=i&&(d.isSendRate=!0,b(),f.detach(window,"scroll",c))}var d=this,h=g.get(".J_TItemRatesUrl",d._mod),i=g.offset(d._mod).top-g.viewportHeight();d.isSendRate=!1,h&&""!=h.value&&f.on(window,"scroll",c)},_fixMinMax:function(){var c,d,e,f=this;if(null!=g.parent(f._mod,".col-sub"))c=n["col-sub"];else if(null!=g.parent(f._mod,".col-extra"))c=n["col-extra"];else{var h=g.parent(f._mod,".layout"),i=["grid-m","grid-m0","grid-s5m0","grid-m0s5","grid-s5m0e5","grid-m0s5e5","grid-s5e5m0","grid-e5s5m0","grid-e5m0s5","grid-m0e5s5"];for(e=0,l=i.length;e<l&&!g.hasClass(h,i[e]);e++);c=n[i[e]]}var j=["item1line1","item3line1","item30line1","item4line1","item5line1","item7line1"],k=g.get("div",g.get(".skin-box-bd",f._mod));for(e=0,l=j.length;e<l&&!g.hasClass(k,"."+j[e]);e++);if(d=c[j[e]],void 0!=d){var m=d,o=g.query("img",f._mod),p={},q=["minWidth","minHeight","maxWidth","maxHeight"];for(e=0,l=m.length;e<l;e++)0!==parseInt(m[e])&&(p[q[e]]=!0,p[q[e]+"Value"]=parseInt(m[e]));a.each(o,function(a){new b(a,p)})}}}),d.selector=".tshop-pbsm-shop-item-recommend",d},{requires:["wangpu/decoration/compatible"]});KISSY.add("modules/shop/srch-inshop/index",function(a){function b(b){var e=d.get(b.mod);if(e){a.log("TshopPbsmShopSrchInshop init start");var f=d.get(".J_TKeyword",e),g=d.query(".J_TCheckPrice",e),h=d.query(".J_TSubmitBtn",e);c.on(f,"focus",function(a){var b=a.target;d.removeClass(b,"prompt"),d.val(b,"")}),c.on(g,"keyup",function(a){var b=/\D/g,c=a.target,e=d.val(c);d.val(c,e.replace(b,""))}),c.on(h,"click",function(a){var b=a.currentTarget,c=d.parent(b,"form");c.submit()}),a.log("TshopPbsmShopSrchInshop init end")}}var a=KISSY,c=a.Event,d=a.DOM;return b.selector=".tshop-pbsm-shop-srch-inshop",b});KISSY.add("modules/shop/self-defined/index",function(a){function b(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var a=KISSY,c=a.Event,d=a.DOM,e=document;return a.augment(b,{_init:function(){a.log("TshopPbsmShopSelfDefined init start");var b=this;b._initFilter(),b._initBanner(),a.log("TshopPbsmShopSelfDefined init end")},_initFilter:function(){var b,d,f=this,g="\u60a8\u9009\u4e2d\u7684\u5185\u5bb9\u53ef\u80fd\u6709\u5b89\u5168\u9690\u60a3,\u8bf7\u8c28\u614e\u4f7f\u7528! ",h=f._mod,i=e.createElement("div"),j="<.+(?:",k=").+>",l="\\s*",m=/[\r\n]+/g,n=[["display","none"],["visibility","hidden"],["width","0"],["text-indent","-\\d{3,}"]],o=[];a.each(n,function(a){o.push(a[0]+l+":"+l+a[1])}),b=j+o.join("|")+k,d=new RegExp(b,"mi"),c.on(h,"copy",function(a){var b,c;window.getSelection?b=window.getSelection():e.selection&&(b=e.selection.createRange()),c=b.htmlText||b.getRangeAt(0).cloneContents(),"string"!=typeof c&&(i.appendChild(c),c=i.innerHTML),c=c.replace(m,""),d.test(c)&&(alert(g),a.halt()),i.innerHTML=""})},_initBanner:function(){var b=d.get(".J_TBannerMaker",this._mod);if(b){var c=d.attr(b,"data-jsurl");c&&a.getScript(c,function(){BM&&BM.getURL(function(a){d.attr(b,"src",a)})})}}}),b.selector=".tshop-pbsm-shop-self-defined",b});KISSY.add("modules/shop/coupon/index",function(a,b,c){function d(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var a=KISSY,e=a.DOM,f=a.Event;return a.augment(d,{_init:function(){a.log("TshopPbsmShopCoupon init start"),this._pngInit(),this._bindEvt(),a.log("TshopPbsmShopCoupon init end")},_pngInit:function(){var b=this;a.UA.ie&&a.UA.ie<7&&(a.each(e.query(".item,.icon",b._mod),function(a){new c(a,{png:!0,png_bg:!0})}),a.each(e.query("img",b._mod),function(a){new c(a,{png:!0,png_tag:!0}),e.css(e.parent(a),"display","none")}))},_bindEvt:function(){var c=this,d=e.query(".item",c._mod);a.each(d,function(d){var g=e.attr(d,"data-url")+"&applySource=shop",h="<iframe style='border:none;height:100%;width:100%' src="+g+">";f.on(d,"mouseenter",function(){e.css(e.get(".item-hover",d),"display","block")}),f.on(d,"mouseleave",function(){e.css(e.get(".item-hover",d),"display","none")}),f.on(d,"click",function(d){var f=d.target;e.hasClass(f,"situation")||(c.getCoupon&&c.getCoupon.destroy(),c.getCoupon=new b.Dialog({content:h,zIndex:1e8,elCls:"ds-getCoupon",elStyle:{position:6==a.UA.ie?"absolute":"fixed"},align:{points:["cc","cc"]},closeAction:"destroy"}),c.getCoupon.render(),c.getCoupon.show())})})}}),d.selector=".tshop-pbsm-shop-coupon",d},{requires:["overlay","wangpu/decoration/compatible"]});KISSY.add("modules/shop/ww-hover/index",function(S,Cookie,Compatible){function TshopPsmShopWwHover(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var Event=S.Event,DOM=S.DOM,Node=S.Node,Anim=S.Anim,UA=S.UA,doc=document,docBody=doc.body,isIE6=6===UA.ie,isShop=window.shop_config?!0:!1,isDaily=!!(location.host.indexOf("daily.")>=0);return S.augment(TshopPsmShopWwHover,{_init:function(){S.log("TshopPsmShopWwHover init start");var a=this;a.isOldWW=DOM.get(".first-block",a._mod),a._setPosForDetail(),a._bindHover(),a._top(),a._dealWW(),a._dealSignin(),a._dealScroll(),a._dealScrollForDetail(),S.log("TshopPsmShopWwHover init end")},_dealSignin:function(){function a(b){d--<0||("complete"==document.readyState?b():setTimeout(function(){a(b)},100))}var b=this,c=DOM.get(".J_Signin",b._mod),d=100;c&&window.shop_config&&a(function(){var a=DOM.get("a",c),b=a.href,d=DOM.val("#J_TokenField");S.use("modules/component/taojinbi/",function(e,f){var g=new f({sellerId:shop_config.userId,token:d,shopUrl:"//"+location.host});g.getActStatus(function(d){d&&d.sign&&(window.login_config&&login_config.loginUserId?g.isSign(function(d){d&&d.has_signed&&(DOM.addClass(c,"signed"),a.href=b.replace(/(&|\?)signin=true/i,"$1")),DOM.show(c)}):DOM.show(c))})})})},_fixedForIE6:function(){if(isIE6);},_setPosForDetail:function(){function a(){var a=DOM.offset(c).left+d+10;DOM.css(b._mod,{left:a})}if(!isShop){var b=this,c=DOM.get("#detail"),d=DOM.width(c);c&&(a(),DOM.show(b._mod),Event.on(window,"resize",S.buffer(a,100)))}},_bindHover:function(){var a=this,b=DOM.get(".skin-box-bd",a._mod),c=DOM.get(".WW",a._mod),d=DOM.query(".img",DOM.get(".skin-box-hd",this._mod));Event.on([c,b],"mouseenter",function(){if((!a.onlyMainWW||isShop)&&DOM.css(b,"display"," block"),!a.isSetBDPos){var d=DOM.offset(c).top+DOM.height(c)/2,e=DOM.height(b);DOM.offset(b,{top:d-e/2}),a.isSetBDPos=!0}S.later(function(){(!a.onlyMainWW||isShop)&&DOM.css(b,"display","block")},300)}),Event.on([c,b],"mouseleave",function(){S.later(function(){a.hideWW(),DOM.css(b,"display","none")},300)}),Event.on(d,"mouseenter",function(a){DOM.addClass(a.currentTarget,"hover")}),Event.on(d,"mouseleave",function(a){DOM.removeClass(a.currentTarget,"hover")})},_top:function(){var a=this,b=DOM.get(".toTop",a._mod);Event.on(b,"click",function(a){a.halt(),DOM.scrollTop(0)})},_dealWW:function(){var self=this,uls=Node.all(".wws",self._mod),node=uls.item(uls.length-1),tempwangwang,templi,tempdesc,api="//amos.alicdn.com/",config="groupid=0&v=2&site=cntaobao&s=1&charset=utf-8&uid=",url=node.attr("data-url"),nick=node.attr("data-nick"),gnick=node.attr("data-gnick"),groupIdFilter=node.attr("data-group-filter").split("@_@"),wwContent=DOM.get(".skin-box-bd",self._mod);node.children().innerHTML=null,""!=url&&S.getScript(url,function(){try{var groups=eval("("+groupMember+")").groups}catch(err){var groups=""}var showMainWW=function(){DOM.css(DOM.query(".service-block",wwContent)[1],"display","none"),self.onlyMainWW=!0};if(isShop||(self.onlyMainWW=!0),""!=groups&&groups.group&&groups.group.length&&""!=groupIdFilter[0]){var groupMembers=groups.group,count=0;if(S.each(groupMembers,function(a,b){(S.inArray(groupMembers[b].groupId.toString(),groupIdFilter)||"all"==groupIdFilter[0])&&(templi=DOM.create("<li>",{"class":"group"}),tempdesc=DOM.create("<span>",{"class":"groupname"}),DOM.html(tempdesc,groupMembers[b].groupName),tempwangwang=DOM.create("<a>",{href:api+"getcid.aw?v=3&uid="+gnick+"&site=cntaobao&groupid="+groupMembers[b].groupId+"&s=1&charset=gbk&fromid=cntaobao"+(S.Cookie.get("_nk_")?S.fromUnicode(S.Cookie.get("_nk_")):""),target:"_blank"}),tempwangwang.appendChild(DOM.create("<img>",{src:api+"grponline.aw?v=3&uid="+gnick+"&site=cntaobao&gids="+groupMembers[b].groupId+"&s=1",alt:"\u70b9\u51fb\u8fd9\u91cc\u7ed9\u6211\u53d1\u6d88\u606f"})),templi.appendChild(tempdesc),DOM.insertAfter(tempwangwang,tempdesc),node.append(templi),count++)}),count){self.onlyMainWW=!1,DOM.addClass(self._mod,"has-group"),self.hideWW();var moreWW=DOM.get(".more-WW",self._mod),allWW=DOM.query(".group",self._mod);allWW.length>5&&(Event.on(moreWW,"click",function(){DOM.css(moreWW,"display","none");for(var a=5;a<allWW.length;a++)DOM.css(allWW[a],"display","block")}),Event.on(moreWW,"mouseenter",function(){DOM.addClass(moreWW,"more-WW-hover")}),Event.on(moreWW,"mouseleave",function(){DOM.removeClass(moreWW,"more-WW-hover")}))}else showMainWW()}else showMainWW()})},_dealScroll:function(){function a(){var a=DOM.scrollTop(),c=DOM.viewportHeight();DOM.css(b._mod,{top:a+c-300})}var b=this,c=(DOM.get(".WW",b._mod),DOM.get(".toTop",b._mod)),d=DOM.get(".suggestion",b._mod),e=DOM.get(".item-qr",b._mod),f=window,g=!1;Event.on(f,"scroll",function(){DOM.scrollTop()>=window.screen.height&&!g?(c&&DOM.removeClass(c,"tb-scrolling"),d&&DOM.removeClass(d,"tb-scrolling"),e&&DOM.removeClass(e,"tb-scrolling"),g=!0):DOM.scrollTop()<window.screen.height&&g&&(c&&DOM.addClass(c,"tb-scrolling"),d&&DOM.addClass(d,"tb-scrolling"),e&&DOM.addClass(e,"tb-scrolling"),g=!1)}),isIE6&&Event.on(f,"scroll",S.buffer(a,100))},_dealScrollForDetail:function(){if(!isShop&&!isIE6&&window.DT){var a=this;DT.Messenger.on("ui:tabbar:unstick",function(){var b=DOM.viewportHeight()-DOM.height(a._mod)-55;DOM.css(a._mod,{top:"auto",bottom:b}),S.later(function(){Anim(a._mod,{bottom:300},.3,"ease").run()},0)}),DT.Messenger.on("ui:tabbar:stick",function(){var b=DOM.css(a._mod,"top");DOM.css(a._mod,{top:b}),S.later(function(){Anim(a._mod,{top:55},.3,"ease").run()},0)})}},hideWW:function(){var a=this,b=DOM.get(".more-WW",a._mod),c=DOM.query(".group",a._mod);if(c.length>5){for(var d=5;d<c.length;d++)DOM.css(c[d],"display","none");DOM.css(b,"display","block")}}}),TshopPsmShopWwHover.selector=".tshop-psm-shop-ww-hover",TshopPsmShopWwHover},{requires:["cookie"]});KISSY.add("modules/shop/new-signboard/index",function(a,b){function c(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function d(b){var c=a.now();return b+(-1===b.indexOf("?")?"?":"&")+"t="+c}function e(b){var c=a.DOM.val("#J_TokenField");return b+(-1===b.indexOf("?")?"?":"&")+"_tb_token_="+c}function f(a,b,c){var d=Math.ceil(.45*h.viewportHeight()+h.scrollTop())-c/2,e=Math.ceil((h.docWidth()-b)/2);h.offset(a,{top:d,left:e})}var g,h,i,j;return g=a.all,h=a.DOM,i=a.Event,UA=a.UA,j=1===g_config.appId||(window.g_config?window.g_config.preview:void 0),a.augment(c,{_init:function(){var a=this;a._initCollect(),a._initQualification(),a._initWeitaoBtn()},_initQualification:function(){function a(a){var b=a,c=h.siblings(b);h.addClass(b,"actived"),h.removeClass(c,"actived")}function b(b){if(UA.ie&&UA.ie<=6)return void c(b);if(b){if(1===j)return;j--}else{if(j>=m)return;j++}h.removeClass(e,"page2 page3"),h.addClass(e,"page"+j),a(k[3*(j-1)])}function c(b){if(b){if(1===j)return;j--}else if(b===!1){if(j>=m)return;j++}var c=3*(j-1),d=[].slice.call(k,c,c+3);h.hide(k),h.css(d,"display","inline"),a(k[c])}var d=this,e=h.get(".J_TQLFTBox",d._mod),f=h.get(".J_TQLeft",d._mod),g=h.get(".J_TQRight",d._mod),j=1,k=h.query(".J_TIconItem",d._mod),l=k.length,m=Math.ceil(l/3);l>3&&h.addClass(e,"more-than-3"),UA.ie&&UA.ie<=6&&c(),i.on(f,"click",function(){b(!0)}),i.on(g,"click",function(){b(!1)}),i.delegate(e,"mouseenter",".J_TIconItem",function(b){a(b.currentTarget)}),a(k[0])},_initCollect:function(){var a=this;a._handleTriggerCollect()},_handleTriggerCollect:function(){var a=this,b=h.get("#popupPanel");i.delegate(a._mod,"click",".J_TCollectShop",function(a){a.preventDefault();var c=a.target,g=c.getAttribute("data-width"),i=c.getAttribute("data-height");h.css(b,"display","none");var j=e(d(c.href)),k='<a class="close-btn" href="#">X</a><iframe src="'+j+'" width="'+g+'" height="'+i+'" name="popupIframe" frameborder="0" scrolling="no"></iframe><div class="tb-canvas"></div>';h.html(b,k),h.css(b,{visibility:"visible",display:"block",width:g,height:i}),f(b,g,i)})},_initWeitaoBtn:function(){var a=this,b=h.get("#popupPanel");i.delegate(a._mod,"click",".J_TWeitaoFlw",function(a){a.preventDefault(),TB.Global.use("fn-login",function(c,e){e.Mini.popup(function(){var c=a.target,e=c.getAttribute("data-width"),g=c.getAttribute("data-height");h.css(b,"display","none");var i=d(c.href),j='<a class="close-btn" href="#">X</a><iframe src="'+i+'" width="'+e+'" height="'+g+'" name="popupIframe" frameborder="0" scrolling="no"></iframe><div class="tb-canvas"></div>';h.html(b,j),h.css(b,{visibility:"visible",display:"block",width:e,height:g}),f(b,e,g)})})})},_initColloctWeitaoContainer:function(){var a=h.get("#popupPanel");a||(a=h.create('<div id="popupPanel">'),h.append(a,"body"),i.delegate(a,"click",".close-btn",function(b){b.preventDefault(),h.hide(a),iframe=h.get("iframe",a),iframe.contentWindow.sendInvite&&iframe.contentWindow.sendInvite(),h.empty(a)}))}}),c.selector=".tshop-pbsm-signboard",c},{requires:["overlay"]});KISSY.add("modules/shop/weposter-qrcode/index",function(a,b){function c(a){this._mod=a.mod,this._mod&&this._init()}return a.augment(c,{_init:function(){this._drawCode()},_drawCode:function(){a.all("#J_WeposterUrl").length>0&&a.all("#J_WeposterQrcodeBody").length>0&&new b("J_WeposterQrcodeBody",{text:a.DOM.val("#J_WeposterUrl"),width:160,height:160,colorDark:"#333",colorLight:"#fff"})}}),c.selector=".tshop-pbsm-shop-weposter-qrcode",c},{requires:["kg/qrcode/2.0.1/"]});KISSY.add("modules/other/customer-service/index",function(S){function TshopPbsmOtherCustomerService(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var S=KISSY,DOM=S.DOM,Node=S.Node;return S.augment(TshopPbsmOtherCustomerService,{_init:function(){S.log("TshopPbsmOtherCustomerService init start");var a=this;a._displayWWGroop(),S.log("TshopPbsmOtherCustomerService init end")},_displayWWGroop:function(){var self=this,tempwangwang,templi,tempdesc,api="//amos.alicdn.com/",config="groupid=0&v=2&site=cntaobao&s=1&charset=utf-8&uid=",uls=Node.all("ul.service-group",self._mod),node=uls.item(uls.length-1),url=node.attr("data-url"),nick=node.attr("data-nick"),gnick=node.attr("data-gnick"),groupIdFilter=node.attr("data-group-filter").split("@_@");node.children().innerHTML=null,""!=url&&S.getScript(url,function(){try{var groups=eval("("+groupMember+")").groups}catch(err){var groups=""}var showMainWW=function(){templi=DOM.create("<li>",{"data-wangwang":"mainwangwang"}),tempdesc=DOM.create("<span>",{"class":"groupname"}),DOM.html(tempdesc,"\u5ba2\u670d\u4e2d\u5fc3"),tempwangwang=DOM.create("<a>",{href:api+"getcid.aw?"+config+nick+"&fromid=cntaobao"+(S.Cookie.get("_nk_")?S.fromUnicode(S.Cookie.get("_nk_")):""),target:"_blank"}),tempwangwang.appendChild(DOM.create("<img>",{src:api+"online.aw?"+config+nick,alt:"\u70b9\u51fb\u8fd9\u91cc\u7ed9\u6211\u53d1\u6d88\u606f"})),templi.appendChild(tempdesc),DOM.insertAfter(tempwangwang,tempdesc),node.append(templi)};if(""!=groups&&groups.group&&groups.group.length&&""!=groupIdFilter[0]){var groupMembers=groups.group,count=0;S.each(groupMembers,function(a,b){(S.inArray(groupMembers[b].groupId.toString(),groupIdFilter)||"all"==groupIdFilter[0])&&(templi=DOM.create("<li>",{"class":"group"}),tempdesc=DOM.create("<span>",{"class":"groupname"}),DOM.html(tempdesc,groupMembers[b].groupName),tempwangwang=DOM.create("<a>",{href:api+"getcid.aw?v=3&uid="+gnick+"&site=cntaobao&groupid="+groupMembers[b].groupId+"&s=1&charset=gbk&fromid=cntaobao"+(S.Cookie.get("_nk_")?S.fromUnicode(S.Cookie.get("_nk_")):""),target:"_blank"}),tempwangwang.appendChild(DOM.create("<img>",{src:api+"grponline.aw?v=3&uid="+gnick+"&site=cntaobao&gids="+groupMembers[b].groupId+"&s=1",alt:"\u70b9\u51fb\u8fd9\u91cc\u7ed9\u6211\u53d1\u6d88\u606f"})),templi.appendChild(tempdesc),DOM.insertAfter(tempwangwang,tempdesc),node.append(templi),count++)}),count||showMainWW()}else showMainWW()})}}),TshopPbsmOtherCustomerService.selector=".tshop-pbsm-other-customer-service",TshopPbsmOtherCustomerService});KISSY.add("modules/other/taoke-recharge/index",function(a){function b(b){var h=this;if(h._mod=b.mod,h._mod&&d.attr("#J_AlimRechargeData","data-value")){var i=a.JSON.parse(d.attr("#J_AlimRechargeData","data-value")),j=i.taokeServer,k={phoneList:"/chongzhi/phone_list.do",phoneSearch:"/chongzhi/phone_search.do",phoneCard:"/chongzhi/phone_card.do"},l={qqList:"/chongzhi/qq_list.do",qqCard:"/chongzhi/qq_card.do"},m={cardList:"/chongzhi/dian_ka_list.do",cardBuy:"/chongzhi/dian_ka.do"},n={onlineList:"/chongzhi/hot_games.do",onlineBuy:"/chongzhi/game_goods_submit.do"},o="mm_"+i.taokepid+"_0_0",p={tel:"//s8.taobao.com/search?q=%B3%E4%D6%B5&ex_q=&filterFineness=&atype=&isprepay=1&promoted_service4=4&user_type=1&olu=yes&commend=all&sort=coefp&style=grid&viewIndex=7&p4p_str=lo1%3D0%26lo2%3D0%26nt%3D1&mode=86&${SearchString}&b=zhl347",card:"//s8.taobao.com/search?q=%B5%E3%BF%A8&${SearchString}&mode=86&rt=1323847099431",gold:"//s8.taobao.com/search?q=qq&{SearchString}&mode=86&rt=1323847137408",online:"//s8.taobao.com/search?q=%CD%F8%D3%CE&unid=0&mode=86&${SearchString}&p4p_str=lo1%3D0%26lo2%3D0%26nt%3D1&cat=50017708&from=compass&navlog=compass-3-c-50017708"},q="\u53f7\u7801\u6709\u8bef,\u8bf7\u91cd\u65b0\u8f93\u5165",r="\u53f7\u7801\u4e0d\u4e00\u81f4,\u8bf7\u91cd\u65b0\u8f93\u5165",s="\u8d27\u7269\u6682\u7f3a",t="\u83b7\u53d6\u6570\u636e\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5",u={create:function(){"undefined"!=typeof localStorage?c=localStorage:g&&(c=f.createElement("input"),c.type="hidden",f.body.appendChild(c),c.addBehavior("#default#userData"))},set:function(a,b){if("setItem"in c)c.setItem(a,b);else if(g)try{c.setAttribute(a,b),c.save("IELocalDataStore")}catch(d){}},get:function(a){if("getItem"in c)return c.getItem(a);if(g)try{return c.load("IELocalDataStore"),c.getAttribute(a)}catch(b){}}},v=function(a){this._gameSubbtn=d.get("#J_AlimGameSubmit",a),this._gameCatD=d.get("#J_AlimGameCatId",a),this._catOpts=this._gameCatD.options,this._gameCatNameD=d.get("#J_AlimGameCatName",a),this._parPriceLabelD=d.get("#J_AlimGameParPrice_label",a),this._parPriceD=d.get("#J_AlimGameParPrice",a),this._parPriceOpts=this._parPriceD.options,this._gameSalePriceEntry=d.get("#J_AlimGameSalePriceEntry",a),this._gameSalePriceLabelD=d.get("#J_AlimGameSalePriceLabel",a),this._gameSalePriceD=d.get("#J_AlimGameSalePrice",a),this._gameCardD=d.get("#J_AlimGameCard",a),this._gameGoldD=d.get("#J_AlimGameGold",a),this._gameOnlineD=d.get("#J_AlimGameOnline",a),this._gameMsgBox=d.get("#J_AlimGameMsgBox",a),this._gameMsgD=d.get("#J_AlimGameMsg",a),this._isGameLackItem=!1,this._currentGameType=null,this.GAME_TYPE={GOLD:"gold",CARD:"card",ONLINE:"online"},this._catIndex=0,this._parPriceIndex=0,this._gameCatsInfo=new Array,this._gameItemsInfo=null,this._searchMore=null;var b=this;window.setTimeout(function(){b.init()},200)};a.augment(v,{init:function(){this._initGameEvent();var a=i.showCard+i.showGold+i.showOnline;a>1?"card"==u.get("gameType")?(d.attr(this._gameCardD,"checked","checked"),this._displayCatName(this._gameCardD)):"gold"==u.get("gameType")?(d.attr(this._gameGoldD,"checked","checked"),this._displayCatName(this._gameGoldD)):"online"==u.get("gameType")?(d.attr(this._gameOnlineD,"checked","checked"),this._displayCatName(this._gameOnlineD)):d.attr(this._gameCardD,"checked")?this._displayCatName(this._gameCardD):d.attr(this._gameGoldD,"checked")?this._displayCatName(this._gameGoldD):d.attr(this._gameOnlineD,"checked")?this._displayCatName(this._gameOnlineD):(d.attr(this._gameCardD,"checked","checked"),this._displayCatName(this._gameCardD)):i.showCard?(this._currentGameType=this.GAME_TYPE.CARD,this._requestCardCatsInfo()):i.showGold?(this._currentGameType=this.GAME_TYPE.GOLD,this._requestQQCatsInfo()):i.showOnline&&(this._currentGameType=this.GAME_TYPE.ONLINE,this._togglePriceEntry("hidden"),this._requestOnlineCatsInfo())},_initGameEvent:function(){var b=this;a.each([b._gameCardD,b._gameGoldD,b._gameOnlineD],function(a){!!a&&e.on(a,"click",function(){b._msgToRecharge(),b._displayCatName(this)})},b),e.on(b._gameCatD,"change",function(){b._catIndex=this.selectedIndex,b._catChange()}),e.on(b._parPriceD,"change",function(){b._parPriceIndex=this.selectedIndex,b._parPriceChange()})},_clearDataCache:function(){this._gameCatsInfo=[],this._gameItemsInfo=null},_markGameLackItem:function(a){this._gameSalePriceLabelD.innerHTML="\u6682\u7f3a\uff1a",this._gameSalePriceD.innerHTML="<a href='"+p[a].replace(/\$\{SearchString\}/,"pid="+o)+"' target='_blank'>\u70b9\u6b64\u641c\u7d22</a>",d.hasClass(this._gameSubbtn,"hidden")||d.addClass(this._gameSubbtn,"hidden")},_displayCatName:function(a){switch(this._clearDataCache(),this._clearPrice(),d.attr(a,"id")){case"J_AlimGameGold":this._currentGameType=this.GAME_TYPE.GOLD,u.set("gameType","gold"),d.text(this._gameCatNameD,"\u79cd\u7c7b\uff1a"),d.text(this._parPriceLabelD,"\u9762\u503c\uff1a"),this._togglePriceEntry("show"),this._requestQQCatsInfo();break;case"J_AlimGameCard":this._currentGameType=this.GAME_TYPE.CARD,u.set("gameType","card"),d.text(this._gameCatNameD,"\u6e38\u620f\uff1a"),d.text(this._parPriceLabelD,"\u9762\u503c\uff1a"),this._togglePriceEntry("show"),this._requestCardCatsInfo();break;case"J_AlimGameOnline":this._currentGameType=this.GAME_TYPE.ONLINE,u.set("gameType","online"),d.text(this._gameCatNameD,"\u6e38\u620f\uff1a"),d.text(this._parPriceLabelD,"\u7269\u54c1\uff1a"),this._togglePriceEntry("hidden"),this._requestOnlineCatsInfo()}},_togglePriceEntry:function(a){"show"===a?d.removeClass(this._gameSalePriceEntry,"hidden"):"hidden"===a&&(d.hasClass(this._gameSalePriceEntry,"hidden")||d.addClass(this._gameSalePriceEntry,"hidden"))},_requestOnlineCatsInfo:function(){var b=this;a.io({dataType:"jsonp",url:j+n.onlineList,success:function(a){return a.success?(b._isGameLackItem=!1,void b.getOnlineCats(a)):(b._isGameLackItem=!0,void b._rechargeToMsg(t,"warning"))}})},getOnlineCats:function(b){return b.data?(a.each(b.data,function(a,b){this._gameCatsInfo.push({catId:b,catData:a})},this),this._fillCatOpts(),void this._catChange()):void h._rechargeToMsg(t,"warning")},_requestCardCatsInfo:function(){var b=this;a.io({dataType:"jsonp",url:j+m.cardList,success:function(a){return a.success?(b._isGameLackItem=!1,void b.getCardCats(a)):(b._isGameLackItem=!0,void b._rechargeToMsg(t,"warning"))}})},getCardCats:function(b){return b.data?(a.each(b.data,function(a,b){this._gameCatsInfo.push({catId:b,catData:a})},this),this._gameCatsInfo.sort(function(a,b){return a.catData.name.localeCompare(b.catData.name)}),this._fillCatOpts(),void this._catChange()):void h._rechargeToMsg(t,"warning")},_requestQQCatsInfo:function(){var b=this;a.io({dataType:"jsonp",url:j+l.qqList,success:function(a){return a.success?(b._isGameLackItem=!1,void b.getQQCats(a)):(b._isGameLackItem=!0,void b._rechargeToMsg(t,"warning"))}})},getQQCats:function(b){return b.data?(a.each(b.data,function(a,b){this._gameCatsInfo.push({catId:b,catData:a})},this),this._fillCatOpts(),void this._catChange()):void h._rechargeToMsg(t,"warning")},_fillCatOpts:function(){var b=this._catOpts;this._recoveryCatOpts(),this._recoveryPrice(),this._gameCatsInfo.length>0&&a.each(this._gameCatsInfo,function(a){b[b.length]=new Option(a.catData.name,a.catId)})},_recoveryCatOpts:function(){this._catOpts.length=0,this._catIndex=0},_recoveryPrice:function(){this._parPriceOpts.length=0,this._parPriceIndex=0,d.text(this._gameSalePriceD,"")},_catChange:function(){this._recoveryPrice(),this._clearPrice(),this._gameItemsInfo=this._gameCatsInfo[this._catIndex],this._fillParPriceOpts(),this._parPriceChange()},_fillParPriceOpts:function(){var b,c,d=this._parPriceOpts;this._currentGameType===this.GAME_TYPE.ONLINE?(b=this._gameItemsInfo?this._gameItemsInfo.catData.goods:[],c=b.length>0?this._gameItemsInfo.catData.pidvid:[]):(b=this._gameItemsInfo?this._gameItemsInfo.catData.price:[],c=b.length>0?this._gameItemsInfo.catData.price_vid:[]),this._msgToRecharge(),a.each(b,function(a,b){d[d.length]=new Option(a,c[b])})},_clearPrice:function(){d.text(this._gameSalePriceLabelD,"\u552e\u4ef7\uff1a"),d.text(this._gameSalePriceD,""),d.hasClass(this._gameSubbtn,"hidden")&&d.removeClass(this._gameSubbtn,"hidden")},_parPriceChange:function(){this._clearPrice();var b=this._parPriceIndex,c=this._gameItemsInfo;switch(this._currentGameType){case this.GAME_TYPE.GOLD:var d=c.catData,e=this;a.io({dataType:"jsonp",url:j+l.qqCard,data:{cat_id:c.catId,price_id:d.price_id,mm_id:o,price_vid:d.price_vid[b],service_id:d.service_id},success:function(a){return a.success?(e._isGameLackItem=!1,void e._fillPriceAndEnableBuy({clickUrl:a.click_url,price:a.price})):(e._isGameLackItem=!0,void e._markGameLackItem("gold"))}});break;case this.GAME_TYPE.CARD:var d=c.catData,e=this;a.io({dataType:"jsonp",url:j+m.cardBuy,data:{cat_id:c.catId,price_id:d.price_id,mm_id:o,price_vid:d.price_vid[b],service_id:d.service_id},success:function(a){return a.success?(e._isGameLackItem=!1,void e._fillPriceAndEnableBuy({clickUrl:a.click_url,price:a.price})):(e._isGameLackItem=!0,void e._markGameLackItem("card"))}});break;case this.GAME_TYPE.ONLINE:var d=c.catData,e=this;e._togglePriceEntry("hidden"),a.io({dataType:"jsonp",url:j+n.onlineBuy,data:{cat_id:c.catId,mm_id:o,pidvid:d.pidvid[b]},success:function(a){return a.success?(e._isGameLackItem=!1,void e._fillPriceAndEnableBuy({clickUrl:a.click_url,price:a.price})):(e._isGameLackItem=!0,e._togglePriceEntry("show"),void e._markGameLackItem("online"))}})}},_fillPriceAndEnableBuy:function(a){d.text(this._gameSalePriceD,a.price),d.attr(this._gameSubbtn,"href",a.clickUrl),this._msgToRecharge()},_rechargeToMsg:function(b,c){d.text(this._gameMsgD,b),d.hasClass(this._gameMsgBox,c)||("dealing"==c&&(d.hasClass(this._gameMsgBox,"warning")&&d.removeClass(this._gameMsgBox,"warning"),d.hasClass(this._gameSubbtn,"hidden")||d.addClass(this._gameSubbtn,"hidden")),d.addClass(this._gameMsgBox,c)),d.hasClass(this._gameMsgBox,"hidden")&&d.removeClass(this._gameMsgBox,"hidden"),a.UA.ie&&8>a.UA.ie&&(d.css(this._telSubbtn,"zoom",""),d.css(this._telSubbtn,"zoom","1"))},_msgToRecharge:function(){d.hasClass(this._gameMsgBox,"hidden")||d.addClass(this._gameMsgBox,"hidden"),a.UA.ie&&8>a.UA.ie&&(d.css(this._telSubbtn,"zoom",""),d.css(this._telSubbtn,"zoom","1"))}});var w=function(a){this._telBoxType=190==d.width(d.parent(a))?"vt":"hz",this._telPanel=d.get(".tel-panel",a),this._telSubbtn=d.get("#J_AlimTelSubmit",a),this._telMsgBoxD=d.get("#J_AlimTelMsgBox",a),this._telMsgD=d.get("#J_AlimTelMsg",a),this._telOperatorD=d.get("#J_AlimTelOperator",a),this._parPriceD=d.get("#J_AlimTelParPrice",a),this._parPriceOpts=this._parPriceD.options,this._telSalePriceLabelD=d.get("#J_AlimTelSalePriceLabel",a),this._telSalePriceD=d.get("#J_AlimTelSalePrice",a),this._telInputD=d.get("#J_AlimTelInput",a),this._telInputCfmD=d.get("#J_AlimTelInputCfm",a),this._telProvinceD=d.get("#J_AlimTelProvince",a),this._telCatNameD=d.get("#J_AlimTelCatName",a),this._isTelLackItem=!1,this._mobilesInfo=new Array,this._getPriceData={},this._getPriceData.mm_id=o,this._initTelEvent(),this._getPrice()};a.augment(w,{_initTelEvent:function(){var a=this;e.on(a._telInputD,"focus",function(){d.hasClass(this,"prompt")&&(d.val(this,""),d.removeClass(this,"prompt")),d.attr(a._telInputCfmD,"disabled")&&d.removeAttr(a._telInputCfmD,"disabled"),a._msgToRecharge()}),e.on(a._telInputCfmD,"focus",function(){d.hasClass(this,"prompt")&&(d.val(this,""),d.removeClass(this,"prompt"))}),e.on(a._telInputD,"paste",function(){return!1}),e.on(a._telInputCfmD,"paste",function(){return!1}),e.on(a._telInputD,"contextmenu",function(){return!1}),e.on(a._telInputCfmD,"contextmenu",function(){return!1}),e.on(a._telInputD,"keyup",function(){var b=/\D/g,c=d.val(this);d.val(this,c.replace(b,"")),d.val(a._telInputCfmD)&&(d.val(a._telInputCfmD,"\u8bf7\u518d\u6b21\u8f93\u5165"),d.addClass(a._telInputCfmD,"prompt")),d.hasClass(a._telOperatorD,"hidden")||d.addClass(a._telOperatorD,"hidden"),a._clearPrice()}),e.on(a._telInputCfmD,"keyup",function(){var a=/\D/g,b=d.val(this);d.val(this,b.replace(a,""))}),e.on(a._telInputD,"blur",function(){("1"!==d.val(this).charAt(0)||d.val(this).length<11)&&(a._rechargeToMsg(q,"warning"),d.attr(a._telInputCfmD,"disabled","disabled"))}),e.on(a._telInputCfmD,"blur",function(){d.val(a._telInputD)!==d.val(a._telInputCfmD)?a._rechargeToMsg(r,"warning"):a._msgToRecharge()}),e.on(a._telInputCfmD,"keyup",function(){11===d.val(a._telInputCfmD).length&&(d.val(a._telInputD)!==d.val(a._telInputCfmD)?a._rechargeToMsg(r,"warning"):(a._msgToRecharge(),a._getOperators()))}),e.on(a._parPriceD,"change",function(){a._priceChange(this)}),e.on(a._telSubbtn,"click",function(b){"1"!==d.val(a._telInputD).charAt(0)||d.val(a._telInputD).length<11?(a._rechargeToMsg(q,"warning"),b.halt()):d.val(a._telInputD)!==d.val(a._telInputCfmD)?(a._rechargeToMsg(r,"warning"),b.halt()):0==a._parPriceOpts.length?(a._rechargeToMsg(s,"warning"),b.halt()):a._isTelLackItem&&b.halt()})},_isPhoneCheckOK:function(a){var b=d.val(this._telInputD),c=d.val(this._telInputCfmD);return"1"!==b.charAt(0)||11!==b.length?(a&&this._rechargeToMsg(q,"warning"),!1):b!==c?(a&&this._rechargeToMsg(r,"warning"),!1):!0},_priceChange:function(b){var c=this;c._clearPrice();var e=b.selectedIndex;c._getPriceData.price_id=c._mobilesInfo[e].id,c._getPriceData.phone=d.val(c._telInputD),c._isPhoneCheckOK()&&a.io({dataType:"jsonp",url:j+k.phoneCard,data:c._getPriceData,success:function(a){return a.success?(c._isTelLackItem=!1,d.text(c._telSalePriceD,a.price),d.attr(c._telSubbtn,"href",a.click_url),d.hasClass(this,"prompt")&&d.removeClass(this,"prompt"),void c._msgToRecharge()):(c._isTelLackItem=!0,void c._markLackItem())}})},_markLackItem:function(){this._telSalePriceLabelD.innerHTML="\u7f3a\u8d27\uff1a",this._telSalePriceD.innerHTML="<a href='"+p.tel.replace(/\$\{SearchString\}/,"pid="+o)+"' target='_blank'>\u70b9\u6b64\u641c\u7d22</a>",d.hasClass(this._telSubbtn,"hidden")||d.addClass(this._telSubbtn,"hidden")},_clearPrice:function(){this._telSalePriceLabelD.innerHTML="\u552e\u4ef7\uff1a",d.text(this._telSalePriceD,""),d.hasClass(this._telSubbtn,"hidden")&&d.removeClass(this._telSubbtn,"hidden")},_rechargeToMsg:function(b,c){var e=this;d.text(e._telMsgD,b),"warning"!=c||b!=q&&b!=r||(d.hasClass(e._telOperatorD,"hidden")||d.addClass(e._telOperatorD,"hidden"),d.hasClass(e._telOperatorD,"operator")&&d.removeClass(e._telOperatorD,"operator")),d.hasClass(e._telMsgBoxD,c)||("dealing"==c&&(d.hasClass(e._telMsgBoxD,"warning")&&d.removeClass(e._telMsgBoxD,"warning"),d.hasClass(e._telSubbtn,"hidden")||d.addClass(e._telSubbtn,"hidden")),d.addClass(e._telMsgBoxD,c)),d.hasClass(e._telMsgBoxD,"hidden")&&d.removeClass(e._telMsgBoxD,"hidden"),a.UA.ie&&8>a.UA.ie&&(d.css(e._telSubbtn,"zoom",""),d.css(e._telSubbtn,"zoom","1"))},_msgToRecharge:function(){d.hasClass(this._telMsgBoxD,"hidden")||d.addClass(this._telMsgBoxD,"hidden"),a.UA.ie&&8>a.UA.ie&&(d.css(this._telSubbtn,"zoom",""),d.css(this._telSubbtn,"zoom","1"))},_getOperators:function(){var b=this;a.io({dataType:"jsonp",url:j+k.phoneSearch,data:{phone:d.val(b._telInputD)},success:function(a){return a.success?(b.displayOperators(a),void b._priceChange(b._parPriceD)):void b._rechargeToMsg(q,"warning")}})},displayOperators:function(a){var b=this;b._getPriceData.cat_id=a.cat_id,b._getPriceData.province_id=a.province_id;var c=a.cat_name.substr(2);d.text(b._telOperatorD,a.province_name+c),d.hasClass(b._telOperatorD,"hidden")&&d.removeClass(b._telOperatorD,"hidden"),d.hasClass(b._telOperatorD,"operator")||d.addClass(b._telOperatorD,"operator"),d.val(b._telProvinceD,a.province),d.val(b._telCatNameD,c)},_getPrice:function(){var b=this;a.io({dataType:"jsonp",url:j+k.phoneList,success:function(a){return a.success?void b.displayPrice(a):void b._rechargeToMsg(t,"warning")}})},displayPrice:function(b){var c=this._parPriceOpts;return b.denomination?(this._mobilesInfo=b.denomination,c.length>0&&(c.length=0),d.hasClass(this._parPriceD,"prompt")&&d.removeClass(this._parPriceD,"prompt"),d.text(this._telSalePriceD,""),void(this._mobilesInfo.length>0&&a.each(this._mobilesInfo,function(a){var b=new Option(a.name,a.id);"100\u5143"===a.name&&(b.selected=!0),c[c.length]=b}))):void this._rechargeToMsg(t,"warning")}}),h._init(u,i,w,v)}}var c,a=KISSY,d=a.DOM,e=a.Event,f=document,g=document.all;return a.augment(b,{_init:function(b,c,d,e){a.log("TshopPbsmOtherTaokeRecharge init start");var f=this;a.ready(function(a){if(b.create(),c.showMobile){new d(f._mod)}if(c.showCard||c.showGold||c.showOnline){new e(f._mod)}}),a.log("TshopPbsmOtherTaokeRecharge init end")}}),b.selector=".tshop-pbsm-other-taoke-recharge",b});KISSY.add("modules/other/guanliantuijian/index",function(S,Template){function TshopPbsmOtherGuanliantuijian(a){var b=a.mod;a.document;b&&!S.get(".guanliantuijian-preview")&&(S.log("TshopPbsmOtherGuanliantuijian init start"),this.pageType=this.checkPageType(),"design"!==this.pageType&&(this.box=Node.one(b),this.con=Node.one(DOM.get(".J_guanliantuijian",b)),this.bd=Node.one(DOM.get(".J_bd",b)),this.moduleRegion=Node.one(DOM.parent(b,".tb-module")),this.bdGrid=Node.one(DOM.get(".J_blocks",b)),this.tpl=Template(Node.one(DOM.get("textarea",b)).val()),this.data=void 0,this.moduleConfig=this.getModuleConfig(),this.fetch(),S.log("TshopPbsmOtherGuanliantuijian init end")))}var S=KISSY,Event=S.Event,DOM=S.DOM,Node=S.Node,GCfg={pageType:{design:"design",detail:"detail",other:"other"},moduleTitle:{view:"\u5927\u5bb6<b>\u770b</b>\u4e86\u4e4b\u540e\u4f1a\u4e70",buy:"\u5927\u5bb6<b>\u4e70</b>\u4e86\u4e4b\u540e\u8fd8\u4f1a\u4e70",same:"\u540c\u7c7b\u70ed\u9500\u5b9d\u8d1d"},APITpl:"//{host}/recommend?appid=1837&itemid={itemId}&count=5&style=h&types={type}",APIHost:location.href.indexOf("daily")>-1?"tui.daily.taobao.net":"tui.taobao.com"};return TshopPbsmOtherGuanliantuijian.prototype={fetch:function(){var a=this;S.IO({type:"get",url:this.getUrl(),success:function(b){a.dataHandle(b),a.render()},dataType:"jsonp",jsonp:"callback"})},dataHandle:function(a){var b=a.result||a.list,c=a.count.split(","),d=a.types.split(","),e=this.moduleConfig,f={blocks:[]},g=this;return S.each(d,function(a,d){var e={type:a,title:GCfg.moduleTitle[a],list:b.splice(0,parseInt(c[d]))};f.blocks.push(e)}),S.each(f.blocks,function(a){var b,c,d,f=/_160x160\.jpg$/;if(b=a.list){for(d=0;b[d];d++)c=b[d].pic,c&&"string"==typeof c&&(c=c.replace(/\s*/g,""),f.test(c)||(b[d].pic=c+"_160x160.jpg"));g.itemSort(b,e.sort)}}),this.data=f,f},itemSort:function(a,b){var c;switch(b){case"default":return;case"price":c="price";break;case"sales":c="sellCount";break;default:return}a.sort(function(a,b){return a[c]-b[c]})},render:function(){var a=this.data,b=this.box,c=0;try{for(var d=0;d<a.blocks.length;d++)c+=a.blocks[d].list.length}catch(e){return void S.log("guanliantuijian data error","error")}c>0?(this.bdGrid.html(this.tpl.render(a)),this.con.show()):DOM.addClass(DOM.parent(b,".box"),"hidden")},getLayoutWidth:function(){return this.moduleRegion?this.moduleRegion.width():0},checkPageType:function(){var a=location.origin;return a="detail.taobao.com",a.indexOf("design.taobao")>=0||a.indexOf("design.daily.taobao")>=0?GCfg.pageType.design:a.indexOf("item.taobao")>=0||a.indexOf("item.daily.taobao")>=0?GCfg.pageType.detail:GCfg.pageType.other},getModuleConfig:function(){return eval("("+this.con.attr("data-config")+")")},getUrl:function(){var a=g_config.idata.item.id,b=(g_config.idata.seller.id,g_config.idata.shop.id);return this.url=S.substitute(GCfg.APITpl,{host:GCfg.APIHost,itemId:a,shopId:b,type:this.moduleConfig.type}),this.url}},TshopPbsmOtherGuanliantuijian.selector=".tshop-pbsm-other-guanliantuijian",TshopPbsmOtherGuanliantuijian},{requires:["wangpu/gallery/template"]});KISSY.add("modules/other/cainixihuan/index",function(a){function b(a){var b=this;b._el=a.mod,b._init(b._el)}function c(b,c,i){var j,k,l,m,n,o,o,p=g.get(".mod-tags",c),q=g.get(".mod-detail",c);if(p&&q){if(0==b.list.length&&!b.listDesc.hasOwnProperty("tags"))return void g.hide(".tshop-um-recommend");var r,s;if(r=b.listDesc.tags,s=b.list,j="",750==i||950==i){for(f=0;f<r.length;f++){var t=r[f];j+="<a class='tags' target='_blank' href='"+shop_url+"/search.htm?keyword="+t.encode+"'>"+t.keyword+"</a>"}j+="<div class='tags-title'>\u4f60\u53ef\u80fd\u5173\u6ce8\u672c\u5e97\u7684</div>"}else if(190==i)for(j+="<div class='tags-title'>\u4f60\u53ef\u80fd\u5173\u6ce8\u672c\u5e97\u7684</div>",f=0;f<r.length;f++){var t=r[f];j+="<a class='tags' target='_blank' href='"+shop_url+"/search.htm?keyword="+t.encode+"'>"+t.keyword+"</a>"}if(g.html(p,j),j="",s.length<=2)return void g.hide(".tshop-um-recommend");for(f=0;f<s.length;f++)s[f].price=e(s[f].price),s[f].promotionPrice=e(s[f].promotionPrice),""==s[f].pic?s[f].pic="//img.alicdn.com/newshop/nopicture.gif":190==i?s[f].pic+="_40x40.jpg":(950==i||750==i)&&(s[f].pic+="_160x160xz.jpg");for(j="<div class='related-items grid'>",j+="<div class='related-items-switchable'><div class='ks-switchable-content'>",k=0;2>k;k++){for(j+=k>0?"<ul class='item-list' style='display: none'>":"<ul class='item-list'>",f=5*k,l=0;f<s.length&&5>l;f++,l++){m=s[f];var u;190==i?u=m.name.length>8?m.name.replace(/(.{8}).*$/,"$1..."):m.name:(750==i||950==i)&&(u=m.name.length>24?m.name.replace(/(.{24}).*$/,"$1..."):m.name);var v="<p class='tuijian-price tuijian-light'><b class='yen'>&yen;</b><b class='price'>"+m.price+"</b></p>";0!=m.promotionPrice&&(v='<p class="tuijian-price"><span class="tuijian-light"><b class="yen">&yen;</b><b class="promotion-price">'+m.promotionPrice+'</b></span><span class="old-price"><b class="price">'+m.price+"</b></span></p>"),n="<li><div class='item'><div class='pic'><a class='side-item' target='_blank' href='"+m.url+"'><img title='"+m.name+"' src='"+m.pic+"'/></a></div><div class='info'><div class='desc'><a class='side-item' style='width' target='_blank' href='"+m.url+"' >"+u+"</a></div>"+v,n+=0==m.monthSellCount?"<div class='month-sell'>\u7b49\u4f60\u6765\u4e70</div>":"<div class='month-sell'>\u5df2\u552e\u51fa<span class='month-sell-count'>"+m.monthSellCount+"</span>\u7b14</div>",n+="</div></div></li>",j+=n}j+="</ul>"}j+="</div></div>",j+="<a href=# class='prev'></a>",j+="<a href=# class='next'></a>",j+="</div>",g.html(q,j);var w,x=g.get(".prev",c),y=g.get(".next",c),z=g.get(".skin-box-hd",c),A=g.get(".related-items-switchable",c),B=g.query(".tags",c);190==i||750==i?w="scrollx":950==i&&(w="fade"),g.css(z,"height","0px"),a.use("wangpu/gallery/switchable",function(a,b){o=new b(A,{hasTriggers:!1,panelCls:"item-list",effect:w,easing:"easeOutStrong",duration:1,markupType:1})}),190==i||950==i?s.length<=5&&(g.hide(x),g.hide(y)):750==i&&s.length<=4&&(g.hide(x),g.hide(y)),h.on(x,"click",function(a){a.preventDefault(),190==i?(g.css(x,"background-position","-134px -8px"),g.css(y,"background-position","-117px -8px"),o.switchTo(0)):(750==i||950==i)&&o.prev()}),h.on(y,"click",function(a){a.preventDefault(),190==i?(g.css(x,"background-position","-117px -8px"),g.css(y,"background-position","-134px -8px"),o.switchTo(1)):(750==i||950==i)&&o.next()}),h.on(B,"click",function(a){var b=g.attr(a.currentTarget,"href"),c="//ju.mmstat.com/?url="+b+"&scm=1007.329.0.0&t="+(new Date).getTime();d(c)})}}function d(a){if(a){var b="hold_"+(new Date).getTime(),c=window[b]=new Image;c.onload=c.onerror=function(){window[b]=null},c.src=a,c=null}}function e(a){return a>99999999?parseFloat(a/1e8).toFixed(2)+"\u4ebf":a>9999?parseFloat(a/1e4).toFixed(2)+"\u4e07":parseFloat(a).toFixed(2)}var f,g=a.DOM,h=a.Event;return b.prototype={_init:function(b){var d,e,f,h,i=g.width(b),j=(new Date).getTime();750==i?f=8:(190==i||950==i)&&(f=10),h=g.attr(".tshop-um-recommend","seller-id"),shop_url=g.attr(".tshop-um-recommend","shop-url"),e=location.host.indexOf("daily")>-1?"tui.daily.taobao.net":"tui.taobao.com",a.IO({dataType:"jsonp",url:"//"+e+"/api/item",data:{p:"u",from:"dianpuhome_guesslike",count:f,sellerid:h,t:j,f:"jp",jsonpCallback:"jsonp"},success:function(a){d=a,c(d,b,i)},error:function(b){a.log("Ajax error:"+b)}})}},b.selector=".tshop-um-recommend",b});