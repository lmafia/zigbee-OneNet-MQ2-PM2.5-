KISSY.add("wangpu/hdc-bridge",["log","io","dom","ua","node"],function(a,b){function c(b){b&&a.isArray(b)&&a.each(b,function(b){a.getScript(b)})}function d(a){return['<style type="text/css">',a||"","</style>"].join("")}function e(a,b){try{k.html(a,b,!0)}catch(c){i.warn("Wangpu html error: %s",c.message)}}function f(b,c,d,f){var g=k.create('<div style="display: none"></div>'),h=null;for(k.prepend(g,document.body),e(g,c);g.firstChild;)8!==g.firstChild.nodeType?(h=g.firstChild.cloneNode(!0),"side"==f&&-1!=Object.prototype.toString.call(h).indexOf("HTMLDivElement")&&a.all(".tshop-signboard",h)&&a.all(".tshop-signboard",h).parent()&&a.all(".tshop-signboard",h).parent().remove(),k.insertBefore(h,b),h.tagName&&"DIV"===h.tagName&&d.push(h),g.removeChild(g.firstChild)):g.removeChild(g.firstChild);k.remove(b),k.remove(g)}function g(a,b,c){e(a,b),c.push(a)}function h(){return l.ios||l.android}var i=b("log").getLogger("wangpu"),j=b("io"),k=b("dom"),l=b("ua"),m=b("node").all,n=({getEnterprise:function(){function b(a,b){return b?a[b]:a}return function(){var c=a.namespace("g_config.idata.item",!0);return b(c,"enterprise")}}()},m("body")),o=150,p=function(a,b,c,d){var e=window.document.createElement("link"),f=b||window.document.getElementsByTagName("script")[0];e.rel="stylesheet",e.href=a,e.media="async",f.parentNode.insertBefore(e,f),setTimeout(function(){e.media=c||"all",d&&d()})},q=function(){var a=/img0(\d)\.taobaocdn\.com/gi,b=function(){var a=!1;try{WebP.isSupport(function(b){a=b})}catch(b){}return a}(),c=function(a){return!a.match(/(png|gif)$/gi)};return{rewrite:function(d,e,f){return(d.match(a)||location.host.indexOf(".daily.")>0)&&(e=e&&b&&c(d),(f||e)&&(d=d.replace(a,"gd$1.alicdn.com")),e&&(d+="_.webp")),d}}}(),r=!0,s=function(){var b={};return a.each(k.query(".J_AsyncDC"),function(a){var c=k.attr(a,"data-type");c&&(b[c]=a)}),b}(),t={_config:null,init:function(b){t._config=b;var c=t._config.async_dc||{},d=c.api;return!d||a.isEmptyObject(s)||h()?void t.noDc():(i.info("Request %s",d),void j({type:"get",url:d+(t.times?"&t="+t.times:""),success:t.newDc,error:t.noDc,dataType:"script",cache:!0}))},parse:function(b){var d=b.mods;b.id;if(b.cb){a.now();b.cb(b.mods)}else a.each(d,function(b,d){try{var e=(a.now(),b.assets||{}),f=b.cb;b.m;c(e.css),b.name=d,f(b),c(e.js)}catch(g){a.log(g)}})},times:0,retry:function(){var a=this;return a.times<1?(a.times+=1,i.info("Retry request"),a.init(),void 0):!0},newDc:function(){function b(){var a=d(g.styleCode),b=m(a);m(".J_AsyncDC[data-type=css]").append(b)}function c(b){a.getScript(g.globalCssUrl,{success:function(){var a=g.styleCode;k.addStyleSheet(a),b&&b()}})}function e(){if(t._config.showShopHeader&&window.SHOP_DC&&window.SHOP_DC.headArchive){var a=m("#J_Header");a&&(a.html(window.SHOP_DC.headArchive),a.one(".tshop-psm-shop-ww-hover").remove()),m(".tshop-psm-shop-header").css({"z-index":"100000000"}),window.Light.light()}}function f(){m("#J_DcHead")&&m("#J_DcHead").css("height","auto")}if(!window.SHOP_DC)return i.warn("Request failed"),void(t.retry()&&(i.warn("Request failed then retry request failed"),t.noDc()));var g=window.SHOP_DC,h={},j={},o=function(a){var b={};return b.data=a,b};if("errorMsg"in g&&!g.globalCssUrl){if(i.warn("Server response error"),t.retry()){"\u88c5\u4fee\u8fd4\u56de\u9519\u8bef:"+g.errorMsg;i.warn("Response error then retry request failed"),t.noDc()}}else{i.info("Init end"),l.ie?c(function(){e(),f()}):(p(g.globalCssUrl,void 0,void 0,function(){e(),f()}),b()),r=g.newTemplate,h.mods=j,h.cb=t.dc,j.head=o(g.header),j.side=o(g.left),j.main=o(g.right),j.foot=o(g.footer),t.parse(h),g.showLeft===!1&&n.fire("switcher:expand");var q="",s={1:"//img.alicdn.com/tps/TB1O_pOKpXXXXXXXFXXXXXXXXXX-113-21.png",2:"//img.alicdn.com/tps/TB1Zs4vKpXXXXXAaXXXXXXXXXXX-113-21.png"},u="//img.alicdn.com/tps/TB11PxtKpXXXXaWaXXXXXXXXXXX-113-21.png";r?g.isSmartVersion?q='<div class="shop-info"><a target="_blank" class="version" href="//wangpu.taobao.com/wangpu/comparation.htm?spm=a1z10.1.0.192.KUW8sQ"><img src="'+u+'" /></a></div>':s[g.siteCategory]&&(q='<div class="shop-info"><a target="_blank" class="version" href="//wangpu.taobao.com/wangpu/comparation.htm?spm=a1z10.1.0.192.KUW8sQ"><img src="'+s[g.siteCategory]+'" /></a></div>'):q='<div id="wangpu-copyright" class="grid-c" data-spm="1000376"><p><a data-spm="d1" href="//wangpu.taobao.com?spm=2013.1.1000376.1">\u672c\u5e97\u6240\u4f7f\u7528\u65fa\u94fa\u7248\u672c:'+g.categoryName+"</a></p></div>",k.get("#copyright").innerHTML=q}},dc:function(){var b=document.createElement("div"),c=g_config.vdata.sys.toggle,d=function(a,b){var c=k.attr(a,b);c&&k.attr(a,b,q.rewrite(c,g_config.webp,g_config.newDomain))},e=function(e,f){return e=e.replace('class="col-sub','class="col-sub tb-shop'),b.innerHTML="a"+e,c&&"false"===c.dcP?a.each(k.query("img",b),function(a){a.src="//g.alicdn.com/s.gif",k.removeAttr(a,"data-ks-lazyload")}):a.each(k.query("img",b),function(a){d(a,"src"),d(a,"data-ks-lazyload")}),b.innerHTML.substring(1)};return function(b){var c=window.g_config,d=(c.assetsHost,t._config.isv),h=[];a.each(b,function(a,b){var c=s[b];if(b&&c){var d=e(a.data,b);"main"===b||"head"===b?g(c,d,h):f(c,d,h,b),delete s[b]}}),n.fire("dc:decoration:start"),k.css(k.next(k.parent("#J_MainWrap")),"margin-top","-17px");var i=m("#hd");if(i&&i.length){var j=i.height();o>j&&i.parent().css("height","auto")}r||a.config({packages:[{name:"wangpu",path:"//g.alicdn.com/shop/taesite/0.1.13/old-tpl",ignorePackageNameInUri:r,charset:"utf-8"}]}),r?a.use("wangpu/dc",function(a,b){b.init({pageType:"cdetail",lazyContainers:h,isvParams:d}),n.fire("dc:decorated")}):a.use("wangpu/init",function(a,b){b.init({pageType:"cdetail",lazyContainers:h,isvParams:d}),n.fire("dc:decorated")})}}(),noDc:function(){m("#J_DcHead").hide(),s.css&&g(s.css,d(),[]),a.all(".tb-switch-bar").hide(),n.fire("switcher:expand")}};return t});